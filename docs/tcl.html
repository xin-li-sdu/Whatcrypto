<!doctype html>
<html lang="en" data-color-mode="dark">
<head>
<meta charset="utf-8">
<title># Verilog

Verilog HDL（简称 Verilog ）是一种硬件描述语言，用于数字电路的系统设计。可对算法级、门级、开关级等多种抽象设计层次进行建模，适合硬件密码学编程。

## 基础语法

### 格式

Verilog 是区分大小写的，格式自由，可以在一行内编写，也可跨多行编写。

每个语句必须以分号为结束符。空白符（换行、制表、空格）都没有实际的意义，在编译阶段可忽略。例如下面两中编程方式都是等效的。

**不换行（不推荐）**

```verilog
**wire** [1:0] results ;**assign** results  &#x26;  tcl cheatsheet &#x26;  Whatcrypto</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta description="# Verilog

Verilog HDL（简称 Verilog ）是一种硬件描述语言，用于数字电路的系统设计。可对算法级、门级、开关级等多种抽象设计层次进行建模，适合硬件密码学编程。，为开发人员分享快速参考备忘单。">
<meta keywords="tcl,reference,Quick,Reference,cheatsheet,cheat,sheet">
<link rel="icon" href="data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%221em%22%20width%3D%221em%22%3E%20%3Cpath%20d%3D%22m21.66%2010.44-.98%204.18c-.84%203.61-2.5%205.07-5.62%204.77-.5-.04-1.04-.13-1.62-.27l-1.68-.4c-4.17-.99-5.46-3.05-4.48-7.23l.98-4.19c.2-.85.44-1.59.74-2.2%201.17-2.42%203.16-3.07%206.5-2.28l1.67.39c4.19.98%205.47%203.05%204.49%207.23Z%22%20fill%3D%22%23c9d1d9%22%2F%3E%20%3Cpath%20d%3D%22M15.06%2019.39c-.62.42-1.4.77-2.35%201.08l-1.58.52c-3.97%201.28-6.06.21-7.35-3.76L2.5%2013.28c-1.28-3.97-.22-6.07%203.75-7.35l1.58-.52c.41-.13.8-.24%201.17-.31-.3.61-.54%201.35-.74%202.2l-.98%204.19c-.98%204.18.31%206.24%204.48%207.23l1.68.4c.58.14%201.12.23%201.62.27Zm2.43-8.88c-.06%200-.12-.01-.19-.02l-4.85-1.23a.75.75%200%200%201%20.37-1.45l4.85%201.23a.748.748%200%200%201-.18%201.47Z%22%20fill%3D%22%23228e6c%22%20%2F%3E%20%3Cpath%20d%3D%22M14.56%2013.89c-.06%200-.12-.01-.19-.02l-2.91-.74a.75.75%200%200%201%20.37-1.45l2.91.74c.4.1.64.51.54.91-.08.34-.38.56-.72.56Z%22%20fill%3D%22%23228e6c%22%20%2F%3E%20%3C%2Fsvg%3E" type="image/svg+xml">
<link rel="stylesheet" href="..\style\style.css">
<link rel="stylesheet" href="..\style\katex.css">
</head>
<body><nav class="header-nav"><div class="max-container"><a href="..\index.html" class="logo"><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" height="1em" width="1em">
  <path d="m21.66 10.44-.98 4.18c-.84 3.61-2.5 5.07-5.62 4.77-.5-.04-1.04-.13-1.62-.27l-1.68-.4c-4.17-.99-5.46-3.05-4.48-7.23l.98-4.19c.2-.85.44-1.59.74-2.2 1.17-2.42 3.16-3.07 6.5-2.28l1.67.39c4.19.98 5.47 3.05 4.49 7.23Z" fill="#c9d1d9"></path>
  <path d="M15.06 19.39c-.62.42-1.4.77-2.35 1.08l-1.58.52c-3.97 1.28-6.06.21-7.35-3.76L2.5 13.28c-1.28-3.97-.22-6.07 3.75-7.35l1.58-.52c.41-.13.8-.24 1.17-.31-.3.61-.54 1.35-.74 2.2l-.98 4.19c-.98 4.18.31 6.24 4.48 7.23l1.68.4c.58.14 1.12.23 1.62.27Zm2.43-8.88c-.06 0-.12-.01-.19-.02l-4.85-1.23a.75.75 0 0 1 .37-1.45l4.85 1.23a.748.748 0 0 1-.18 1.47Z" fill="#228e6c"></path>
  <path d="M14.56 13.89c-.06 0-.12-.01-.19-.02l-2.91-.74a.75.75 0 0 1 .37-1.45l2.91.74c.4.1.64.51.54.91-.08.34-.38.56-.72.56Z" fill="#228e6c"></path>
</svg>
<span class="title">Whatcrypto</span></a><div class="menu"><a href="javascript:void(0);" class="searchbtn" id="searchbtn"><svg xmlns="http://www.w3.org/2000/svg" height="1em" width="1em" viewBox="0 0 18 18">
  <path fill="currentColor" d="M17.71,16.29 L14.31,12.9 C15.4069846,11.5024547 16.0022094,9.77665502 16,8 C16,3.581722 12.418278,0 8,0 C3.581722,0 0,3.581722 0,8 C0,12.418278 3.581722,16 8,16 C9.77665502,16.0022094 11.5024547,15.4069846 12.9,14.31 L16.29,17.71 C16.4777666,17.8993127 16.7333625,18.0057983 17,18.0057983 C17.2666375,18.0057983 17.5222334,17.8993127 17.71,17.71 C17.8993127,17.5222334 18.0057983,17.2666375 18.0057983,17 C18.0057983,16.7333625 17.8993127,16.4777666 17.71,16.29 Z M2,8 C2,4.6862915 4.6862915,2 8,2 C11.3137085,2 14,4.6862915 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 Z"></path>
</svg><span>搜索</span><span>⌘K</span></a><a href="https://github.com/xin-li-sdu/xin-li-sdu/blob/main/docs/tcl.md" class="" target="__blank"><svg viewBox="0 0 36 36" fill="currentColor" height="1em" width="1em"><path d="m33 6.4-3.7-3.7a1.71 1.71 0 0 0-2.36 0L23.65 6H6a2 2 0 0 0-2 2v22a2 2 0 0 0 2 2h22a2 2 0 0 0 2-2V11.76l3-3a1.67 1.67 0 0 0 0-2.36ZM18.83 20.13l-4.19.93 1-4.15 9.55-9.57 3.23 3.23ZM29.5 9.43 26.27 6.2l1.85-1.85 3.23 3.23Z"></path><path fill="none" d="M0 0h36v36H0z"></path></svg><span>编辑</span></a><button id="darkMode" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="light" height="1em" width="1em">
  <path d="M6.995 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007-2.246-5.007-5.007-5.007S6.995 9.239 6.995 12zM11 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2H2zm17 0h3v2h-3zM5.637 19.778l-1.414-1.414 2.121-2.121 1.414 1.414zM16.242 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.344 7.759 4.223 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z"></path>
</svg>
<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="dark" height="1em" width="1em">
  <path d="M12 11.807A9.002 9.002 0 0 1 10.049 2a9.942 9.942 0 0 0-5.12 2.735c-3.905 3.905-3.905 10.237 0 14.142 3.906 3.906 10.237 3.905 14.143 0a9.946 9.946 0 0 0 2.735-5.119A9.003 9.003 0 0 1 12 11.807z"></path>
</svg>
</button><script src="../js/dark.js?v=1.5.3"></script><a href="https://github.com/xin-li-sdu/xin-li-sdu" class="" target="__blank"><svg viewBox="0 0 16 16" fill="currentColor" height="1em" width="1em"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a></div></div></nav><div class="wrap h1body-exist max-container"><header class="wrap-header h1wrap"><h1 id="verilog"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="1em" width="1em">
  <path d="M9 9h6v6H9z"></path>
  <path d="M20 6c0-1.103-.897-2-2-2h-2V2h-2v2h-4V2H8v2H6c-1.103 0-2 .897-2 2v2H2v2h2v4H2v2h2v2c0 1.103.897 2 2 2h2v2h2v-2h4v2h2v-2h2c1.103 0 2-.897 2-2v-2h2v-2h-2v-4h2V8h-2V6zM6 18V6h12l.002 12H6z"></path>
</svg>
<a aria-hidden="true" tabindex="-1" href="#verilog"><span class="icon icon-link"></span></a>Verilog</h1><div class="wrap-body">
<p>Verilog HDL（简称 Verilog ）是一种硬件描述语言，用于数字电路的系统设计。可对算法级、门级、开关级等多种抽象设计层次进行建模，适合硬件密码学编程。</p>
</div></header><div class="menu-tocs"><div class="menu-btn"><svg aria-hidden="true" fill="currentColor" height="1em" width="1em" viewBox="0 0 16 16" version="1.1" data-view-component="true">
  <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
</svg></div><div class="menu-modal"><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#基础语法">基础语法</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#格式">格式</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#注释">注释</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#条件语句">条件语句</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#case-语句">case 语句</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#while-循环">while 循环</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#for-循环">for 循环</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#repeat-循环">repeat 循环</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#forever-循环">forever 循环</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#函数">函数</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#代码示例">代码示例</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#aes">AES</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#a51">A51</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#sha256">SHA256</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#montgomery">Montgomery</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#grain_128">Grain_128</a></div></div><div class="h1wrap-body"><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="基础语法"><a aria-hidden="true" tabindex="-1" href="#基础语法"><span class="icon icon-link"></span></a>基础语法</h2><div class="wrap-body">
</div></div><div class="h2wrap-body"><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="格式"><a aria-hidden="true" tabindex="-1" href="#格式"><span class="icon icon-link"></span></a>格式</h3><div class="wrap-body">
<p>Verilog 是区分大小写的，格式自由，可以在一行内编写，也可跨多行编写。</p>
<p>每个语句必须以分号为结束符。空白符（换行、制表、空格）都没有实际的意义，在编译阶段可忽略。例如下面两中编程方式都是等效的。</p>
<p><strong>不换行（不推荐）</strong></p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token operator">**</span><span class="token keyword">wire</span><span class="token operator">**</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> results <span class="token punctuation">;</span><span class="token operator">**</span><span class="token keyword">assign</span><span class="token operator">**</span> results <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1'b0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2'b01</span> ： <span class="token punctuation">(</span>b<span class="token operator">==</span><span class="token number">1'b0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2'b10</span> ： <span class="token number">2'b11</span> <span class="token punctuation">;</span>
</span></code></pre>
<p><strong>换行（推荐）</strong></p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token operator">**</span><span class="token keyword">wire</span><span class="token operator">**</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> results <span class="token punctuation">;</span>
</span><span class="code-line"><span class="token operator">**</span><span class="token keyword">assign</span><span class="token operator">**</span>    results <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1'b0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2'b01</span> ：
</span><span class="code-line">      <span class="token punctuation">(</span>b<span class="token operator">==</span><span class="token number">1'b0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2'b10</span> ：
</span><span class="code-line">        <span class="token number">2'b11</span> <span class="token punctuation">;</span>
</span></code></pre>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="注释"><a aria-hidden="true" tabindex="-1" href="#注释"><span class="icon icon-link"></span></a>注释</h3><div class="wrap-body">
<p>Verilog 中有 2 种注释方式:</p>
<p>用 <strong><code>//</code></strong> 进行单行注释：</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> counter <span class="token punctuation">;</span>  <span class="token comment">// A definition of counter register</span>
</span></code></pre>
<p>用 <strong><code>\*</code></strong> 与 <strong><code>*/</code></strong> 进行跨行注释:</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  addr <span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">/* 
</span></span><span class="code-line"><span class="token comment">Next are notes with multiple lines.
</span></span><span class="code-line"><span class="token comment">Codes here cannot be compiled.
</span></span><span class="code-line"><span class="token comment">*/</span>
</span><span class="code-line"><span class="token keyword">assign</span>   addr <span class="token operator">=</span> <span class="token number">12'b0</span> <span class="token punctuation">;</span>
</span></code></pre>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="条件语句"><a aria-hidden="true" tabindex="-1" href="#条件语句"><span class="icon icon-link"></span></a>条件语句</h3><div class="wrap-body">
<p>条件（if）语句用于控制执行语句要根据条件判断来确定是否执行。</p>
<p>条件语句用关键字 if 和 else 来声明，条件表达式必须在圆括号中。</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span>condition1<span class="token punctuation">)</span>       true_statement1 <span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>condition2<span class="token punctuation">)</span>        true_statement2 <span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>condition3<span class="token punctuation">)</span>        true_statement3 <span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">else</span>                      default_statement <span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>if 语句执行时，如果 condition1 为真，则执行 true_statement1 ；如果 condition1 为假，condition2 为真，则执行 true_statement2；依次类推。</li>
<li>else if 与 else 结构可以省略，即可以只有一个 if 条件判断和一组执行语句 ture_statement1 就可以构成一个执行过程。</li>
<li>else if 可以叠加多个，不仅限于 1 或 2 个。</li>
<li>ture_statement1 等执行语句可以是一条语句，也可以是多条。如果是多条执行语句，则需要用 begin 与 end 关键字进行说明。</li>
</ul>
</div></div></div><div class="wrap h3body-not-exist col-span-2"><div class="wrap-header h3wrap"><h3 id="case-语句"><a aria-hidden="true" tabindex="-1" href="#case-语句"><span class="icon icon-link"></span></a>case 语句</h3><div class="wrap-body">
<!--rehype:wrap-class=col-span-2-->
<p>case 语句格式如下：</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token function">case</span><span class="token punctuation">(</span>case_expr<span class="token punctuation">)</span>
</span><span class="code-line">    condition1     <span class="token punctuation">:</span>             true_statement1 <span class="token punctuation">;</span>
</span><span class="code-line">    condition2     <span class="token punctuation">:</span>             true_statement2 <span class="token punctuation">;</span>
</span><span class="code-line">    ……
</span><span class="code-line">    <span class="token keyword">default</span>        <span class="token punctuation">:</span>             default_statement <span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endcase</span>
</span></code></pre>
<p>case 语句执行时，如果 condition1 为真，则执行 true_statement1 ; 如果 condition1 为假，condition2 为真，则执行 true_statement2；依次类推。如果各个 condition 都不为真，则执行 default_statement 语句。</p>
<p>default 语句是可选的，且在一个 case 语句中不能有多个 default 语句。</p>
<p>条件选项可以有多个，不仅限于 condition1、condition2 等，而且这些条件选项不要求互斥。虽然这些条件选项是并发比较的，但执行效果是谁在前且条件为真谁被执行。</p>
<p>ture_statement1 等执行语句可以是一条语句，也可以是多条。如果是多条执行语句，则需要用 begin 与 end 关键字进行说明。</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="while-循环"><a aria-hidden="true" tabindex="-1" href="#while-循环"><span class="icon icon-link"></span></a>while 循环</h3><div class="wrap-body">
<p>while 循环语法格式如下：</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">while</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">    …
</span><span class="code-line">    …
</span><span class="code-line">    …
</span><span class="code-line"><span class="token keyword">end</span>
</span></code></pre>
<p>while 循环中止条件为 condition 为假。</p>
<p>如果开始执行到 while 循环时 condition 已经为假，那么循环语句一次也不会执行。</p>
<p>当然，执行语句只有一条时，关键字 begin 与 end 可以省略。</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="for-循环"><a aria-hidden="true" tabindex="-1" href="#for-循环"><span class="icon icon-link"></span></a>for 循环</h3><div class="wrap-body">
<p>for 循环语法格式如下：</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token function">for</span><span class="token punctuation">(</span>initial_assignment<span class="token punctuation">;</span> condition <span class="token punctuation">;</span> step_assignment<span class="token punctuation">)</span>  <span class="token keyword">begin</span>
</span><span class="code-line">    …
</span><span class="code-line">    …
</span><span class="code-line">    …
</span><span class="code-line"><span class="token keyword">end</span>
</span></code></pre>
<p>initial_assignment 为初始条件。condition 为终止条件，condition 为假时，立即跳出循环。step_assignment 为改变控制变量的过程赋值语句，通常为增加或减少循环变量计数。一般来说，因为初始条件和自加操作等过程都已经包含在 for 循环中，所以 for 循环写法比 while 更为紧凑，但也不是所有的情况下都能使用 for 循环来代替 while 循环。</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="repeat-循环"><a aria-hidden="true" tabindex="-1" href="#repeat-循环"><span class="icon icon-link"></span></a>repeat 循环</h3><div class="wrap-body">
<p>repeat 循环语法格式如下：</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">repeat</span> <span class="token punctuation">(</span>loop_times<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">    …
</span><span class="code-line">    …
</span><span class="code-line">    …
</span><span class="code-line"><span class="token keyword">end</span>
</span></code></pre>
<p>repeat 的功能是执行固定次数的循环，它不能像 while 循环那样用一个逻辑表达式来确定循环是否继续执行。repeat 循环的次数必须是一个常量、变量或信号。如果循环次数是变量信号，则循环次数是开始执行 repeat 循环时变量信号的值。即便执行期间，循环次数代表的变量信号值发生了变化，repeat 执行次数也不会改变。</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="forever-循环"><a aria-hidden="true" tabindex="-1" href="#forever-循环"><span class="icon icon-link"></span></a>forever 循环</h3><div class="wrap-body">
<p>forever 循环语法格式如下：</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">forever</span> <span class="token keyword">begin</span>
</span><span class="code-line">    …
</span><span class="code-line"><span class="token keyword">end</span>
</span></code></pre>
<p>forever 语句表示永久循环，不包含任何条件表达式，一旦执行便无限的执行下去，系统函数 $finish 可退出 forever。</p>
<p>forever 相当于 while(1) 。</p>
<p>通常，forever 循环是和时序控制结构配合使用的。</p>
</div></div></div><div class="wrap h3body-not-exist col-span-3"><div class="wrap-header h3wrap"><h3 id="函数"><a aria-hidden="true" tabindex="-1" href="#函数"><span class="icon icon-link"></span></a>函数</h3><div class="wrap-body">
<!--rehype:wrap-class=col-span-3-->
<p>函数只能在模块中定义，位置任意，并在模块的任何地方引用，作用范围也局限于此模块。函数主要有以下几个特点：</p>
<ul>
<li>1）不含有任何延迟、时序或时序控制逻辑</li>
<li>2）至少有一个输入变量</li>
<li>3）只有一个返回值，且没有输出</li>
<li>4）不含有非阻塞赋值语句</li>
<li>5）函数可以调用其他函数，但是不能调用任务</li>
</ul>
<p>Verilog 函数声明格式如下：</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">function</span> <span class="token punctuation">[</span>range<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>     function_id <span class="token punctuation">;</span>
</span><span class="code-line">input_declaration <span class="token punctuation">;</span>
</span><span class="code-line"> other_declaration <span class="token punctuation">;</span>
</span><span class="code-line">procedural_statement <span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endfunction</span>
</span></code></pre>
<p>函数在声明时，会隐式的声明一个宽度为 range、 名字为 function_id 的寄存器变量，函数的返回值通过这个变量进行传递。当该寄存器变量没有指定位宽时，默认位宽为 1。</p>
<p>函数通过指明函数名与输入变量进行调用。函数结束时，返回值被传递到调用处。</p>
<p>函数调用格式如下：</p>
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token function">function_id</span><span class="token punctuation">(</span>input1<span class="token punctuation">,</span> input2<span class="token punctuation">,</span> …<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
</div></div></div></div></div><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="代码示例"><a aria-hidden="true" tabindex="-1" href="#代码示例"><span class="icon icon-link"></span></a>代码示例</h2><div class="wrap-body">
</div></div><div class="h2wrap-body"><div class="wrap h3body-not-exist col-span-2 row-span-3"><div class="wrap-header h3wrap"><h3 id="aes"><a aria-hidden="true" tabindex="-1" href="#aes"><span class="icon icon-link"></span></a>AES</h3><div class="wrap-body">
<!--rehype:wrap-class=col-span-2 row-span-3-->
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token comment">//        SubBytes         //</span>
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token keyword">module</span> SubBytes <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> y<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> S<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token number">0</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span>   <span class="token number">1</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">124</span><span class="token punctuation">;</span>   <span class="token number">2</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">119</span><span class="token punctuation">;</span>   <span class="token number">3</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span>   <span class="token number">4</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">242</span><span class="token punctuation">;</span>   <span class="token number">5</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">107</span><span class="token punctuation">;</span>   <span class="token number">6</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">111</span><span class="token punctuation">;</span>   <span class="token number">7</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">197</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token number">8</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">;</span>   <span class="token number">9</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token number">10</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">103</span><span class="token punctuation">;</span>  <span class="token number">11</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">43</span><span class="token punctuation">;</span>  <span class="token number">12</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">254</span><span class="token punctuation">;</span>  <span class="token number">13</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">215</span><span class="token punctuation">;</span>  <span class="token number">14</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">171</span><span class="token punctuation">;</span>  <span class="token number">15</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">118</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">16</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">202</span><span class="token punctuation">;</span>  <span class="token number">17</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">;</span>  <span class="token number">18</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">;</span>  <span class="token number">19</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">125</span><span class="token punctuation">;</span>  <span class="token number">20</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">;</span>  <span class="token number">21</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">89</span><span class="token punctuation">;</span>  <span class="token number">22</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">71</span><span class="token punctuation">;</span>  <span class="token number">23</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">24</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">173</span><span class="token punctuation">;</span>  <span class="token number">25</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">212</span><span class="token punctuation">;</span>  <span class="token number">26</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">162</span><span class="token punctuation">;</span>  <span class="token number">27</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">175</span><span class="token punctuation">;</span>  <span class="token number">28</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">156</span><span class="token punctuation">;</span>  <span class="token number">29</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">164</span><span class="token punctuation">;</span>  <span class="token number">30</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">114</span><span class="token punctuation">;</span>  <span class="token number">31</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">192</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">32</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">183</span><span class="token punctuation">;</span>  <span class="token number">33</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">253</span><span class="token punctuation">;</span>  <span class="token number">34</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">147</span><span class="token punctuation">;</span>  <span class="token number">35</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>  <span class="token number">36</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">54</span><span class="token punctuation">;</span>  <span class="token number">37</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span>  <span class="token number">38</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">247</span><span class="token punctuation">;</span>  <span class="token number">39</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">204</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">40</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">;</span>  <span class="token number">41</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">165</span><span class="token punctuation">;</span>  <span class="token number">42</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">229</span><span class="token punctuation">;</span>  <span class="token number">43</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">241</span><span class="token punctuation">;</span>  <span class="token number">44</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">113</span><span class="token punctuation">;</span>  <span class="token number">45</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">216</span><span class="token punctuation">;</span>  <span class="token number">46</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">;</span>  <span class="token number">47</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">48</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">4</span><span class="token punctuation">;</span>  <span class="token number">49</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">199</span><span class="token punctuation">;</span>  <span class="token number">50</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>  <span class="token number">51</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">195</span><span class="token punctuation">;</span>  <span class="token number">52</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">;</span>  <span class="token number">53</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">;</span>  <span class="token number">54</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token number">55</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">154</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">56</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">7</span><span class="token punctuation">;</span>  <span class="token number">57</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>  <span class="token number">58</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">;</span>  <span class="token number">59</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">226</span><span class="token punctuation">;</span>  <span class="token number">60</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">235</span><span class="token punctuation">;</span>  <span class="token number">61</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">39</span><span class="token punctuation">;</span>  <span class="token number">62</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">178</span><span class="token punctuation">;</span>  <span class="token number">63</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">117</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">64</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">9</span><span class="token punctuation">;</span>  <span class="token number">65</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">131</span><span class="token punctuation">;</span>  <span class="token number">66</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">44</span><span class="token punctuation">;</span>  <span class="token number">67</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">26</span><span class="token punctuation">;</span>  <span class="token number">68</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">;</span>  <span class="token number">69</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">110</span><span class="token punctuation">;</span>  <span class="token number">70</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>  <span class="token number">71</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">160</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">72</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">82</span><span class="token punctuation">;</span>  <span class="token number">73</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">59</span><span class="token punctuation">;</span>  <span class="token number">74</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">214</span><span class="token punctuation">;</span>  <span class="token number">75</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">179</span><span class="token punctuation">;</span>  <span class="token number">76</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">41</span><span class="token punctuation">;</span>  <span class="token number">77</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">227</span><span class="token punctuation">;</span>  <span class="token number">78</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">47</span><span class="token punctuation">;</span>  <span class="token number">79</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">132</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">80</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">83</span><span class="token punctuation">;</span>  <span class="token number">81</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">209</span><span class="token punctuation">;</span>  <span class="token number">82</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token number">83</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">237</span><span class="token punctuation">;</span>  <span class="token number">84</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>  <span class="token number">85</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">252</span><span class="token punctuation">;</span>  <span class="token number">86</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">177</span><span class="token punctuation">;</span>  <span class="token number">87</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">91</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">88</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">106</span><span class="token punctuation">;</span>  <span class="token number">89</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">203</span><span class="token punctuation">;</span>  <span class="token number">90</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">190</span><span class="token punctuation">;</span>  <span class="token number">91</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">57</span><span class="token punctuation">;</span>  <span class="token number">92</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">74</span><span class="token punctuation">;</span>  <span class="token number">93</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">76</span><span class="token punctuation">;</span>  <span class="token number">94</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">88</span><span class="token punctuation">;</span>  <span class="token number">95</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">207</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">96</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">208</span><span class="token punctuation">;</span>  <span class="token number">97</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">239</span><span class="token punctuation">;</span>  <span class="token number">98</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">170</span><span class="token punctuation">;</span>  <span class="token number">99</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">251</span><span class="token punctuation">;</span> <span class="token number">100</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">;</span> <span class="token number">101</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">77</span><span class="token punctuation">;</span> <span class="token number">102</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">51</span><span class="token punctuation">;</span> <span class="token number">103</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">133</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">104</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">69</span><span class="token punctuation">;</span> <span class="token number">105</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">249</span><span class="token punctuation">;</span> <span class="token number">106</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">2</span><span class="token punctuation">;</span> <span class="token number">107</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">127</span><span class="token punctuation">;</span> <span class="token number">108</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span> <span class="token number">109</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span> <span class="token number">110</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">159</span><span class="token punctuation">;</span> <span class="token number">111</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">168</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">112</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">81</span><span class="token punctuation">;</span> <span class="token number">113</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">163</span><span class="token punctuation">;</span> <span class="token number">114</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span> <span class="token number">115</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">143</span><span class="token punctuation">;</span> <span class="token number">116</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">146</span><span class="token punctuation">;</span> <span class="token number">117</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">157</span><span class="token punctuation">;</span> <span class="token number">118</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">;</span> <span class="token number">119</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">245</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">120</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">188</span><span class="token punctuation">;</span> <span class="token number">121</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">182</span><span class="token punctuation">;</span> <span class="token number">122</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">218</span><span class="token punctuation">;</span> <span class="token number">123</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">33</span><span class="token punctuation">;</span> <span class="token number">124</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span> <span class="token number">125</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">;</span> <span class="token number">126</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">243</span><span class="token punctuation">;</span> <span class="token number">127</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">210</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">128</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">205</span><span class="token punctuation">;</span> <span class="token number">129</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span> <span class="token number">130</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span> <span class="token number">131</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">236</span><span class="token punctuation">;</span> <span class="token number">132</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">95</span><span class="token punctuation">;</span> <span class="token number">133</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">151</span><span class="token punctuation">;</span> <span class="token number">134</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">68</span><span class="token punctuation">;</span> <span class="token number">135</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">136</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">196</span><span class="token punctuation">;</span> <span class="token number">137</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">167</span><span class="token punctuation">;</span> <span class="token number">138</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">126</span><span class="token punctuation">;</span> <span class="token number">139</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">61</span><span class="token punctuation">;</span> <span class="token number">140</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span> <span class="token number">141</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">93</span><span class="token punctuation">;</span> <span class="token number">142</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span> <span class="token number">143</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">115</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">144</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">96</span><span class="token punctuation">;</span> <span class="token number">145</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">129</span><span class="token punctuation">;</span> <span class="token number">146</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">79</span><span class="token punctuation">;</span> <span class="token number">147</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">220</span><span class="token punctuation">;</span> <span class="token number">148</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">34</span><span class="token punctuation">;</span> <span class="token number">149</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span> <span class="token number">150</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">;</span> <span class="token number">151</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">136</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">152</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">;</span> <span class="token number">153</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">238</span><span class="token punctuation">;</span> <span class="token number">154</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">184</span><span class="token punctuation">;</span> <span class="token number">155</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token number">156</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">222</span><span class="token punctuation">;</span> <span class="token number">157</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">94</span><span class="token punctuation">;</span> <span class="token number">158</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token number">159</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">219</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">160</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">;</span> <span class="token number">161</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span> <span class="token number">162</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">58</span><span class="token punctuation">;</span> <span class="token number">163</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token number">164</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">73</span><span class="token punctuation">;</span> <span class="token number">165</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">6</span><span class="token punctuation">;</span> <span class="token number">166</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">36</span><span class="token punctuation">;</span> <span class="token number">167</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">92</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">168</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">194</span><span class="token punctuation">;</span> <span class="token number">169</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">211</span><span class="token punctuation">;</span> <span class="token number">170</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">172</span><span class="token punctuation">;</span> <span class="token number">171</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">98</span><span class="token punctuation">;</span> <span class="token number">172</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">145</span><span class="token punctuation">;</span> <span class="token number">173</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">149</span><span class="token punctuation">;</span> <span class="token number">174</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">228</span><span class="token punctuation">;</span> <span class="token number">175</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">121</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">176</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">231</span><span class="token punctuation">;</span> <span class="token number">177</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span> <span class="token number">178</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">55</span><span class="token punctuation">;</span> <span class="token number">179</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">109</span><span class="token punctuation">;</span> <span class="token number">180</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">141</span><span class="token punctuation">;</span> <span class="token number">181</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">213</span><span class="token punctuation">;</span> <span class="token number">182</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">78</span><span class="token punctuation">;</span> <span class="token number">183</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">169</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">184</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">108</span><span class="token punctuation">;</span> <span class="token number">185</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">86</span><span class="token punctuation">;</span> <span class="token number">186</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">244</span><span class="token punctuation">;</span> <span class="token number">187</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">234</span><span class="token punctuation">;</span> <span class="token number">188</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">101</span><span class="token punctuation">;</span> <span class="token number">189</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">122</span><span class="token punctuation">;</span> <span class="token number">190</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">174</span><span class="token punctuation">;</span> <span class="token number">191</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">8</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">192</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">186</span><span class="token punctuation">;</span> <span class="token number">193</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">;</span> <span class="token number">194</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">37</span><span class="token punctuation">;</span> <span class="token number">195</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">46</span><span class="token punctuation">;</span> <span class="token number">196</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">;</span> <span class="token number">197</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">166</span><span class="token punctuation">;</span> <span class="token number">198</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">;</span> <span class="token number">199</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">198</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">200</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">232</span><span class="token punctuation">;</span> <span class="token number">201</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">221</span><span class="token punctuation">;</span> <span class="token number">202</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">116</span><span class="token punctuation">;</span> <span class="token number">203</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">31</span><span class="token punctuation">;</span> <span class="token number">204</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">;</span> <span class="token number">205</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">189</span><span class="token punctuation">;</span> <span class="token number">206</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">139</span><span class="token punctuation">;</span> <span class="token number">207</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">138</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">208</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">112</span><span class="token punctuation">;</span> <span class="token number">209</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">62</span><span class="token punctuation">;</span> <span class="token number">210</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">181</span><span class="token punctuation">;</span> <span class="token number">211</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">102</span><span class="token punctuation">;</span> <span class="token number">212</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">;</span> <span class="token number">213</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">214</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">246</span><span class="token punctuation">;</span> <span class="token number">215</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">216</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">;</span> <span class="token number">217</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">53</span><span class="token punctuation">;</span> <span class="token number">218</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">87</span><span class="token punctuation">;</span> <span class="token number">219</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">185</span><span class="token punctuation">;</span> <span class="token number">220</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">134</span><span class="token punctuation">;</span> <span class="token number">221</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">193</span><span class="token punctuation">;</span> <span class="token number">222</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span> <span class="token number">223</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">158</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">224</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">225</span><span class="token punctuation">;</span> <span class="token number">225</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">248</span><span class="token punctuation">;</span> <span class="token number">226</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">152</span><span class="token punctuation">;</span> <span class="token number">227</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span> <span class="token number">228</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">105</span><span class="token punctuation">;</span> <span class="token number">229</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">217</span><span class="token punctuation">;</span> <span class="token number">230</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">142</span><span class="token punctuation">;</span> <span class="token number">231</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">148</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">232</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">155</span><span class="token punctuation">;</span> <span class="token number">233</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token number">234</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">135</span><span class="token punctuation">;</span> <span class="token number">235</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">233</span><span class="token punctuation">;</span> <span class="token number">236</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">206</span><span class="token punctuation">;</span> <span class="token number">237</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">85</span><span class="token punctuation">;</span> <span class="token number">238</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span> <span class="token number">239</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">223</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">240</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">140</span><span class="token punctuation">;</span> <span class="token number">241</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">161</span><span class="token punctuation">;</span> <span class="token number">242</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">137</span><span class="token punctuation">;</span> <span class="token number">243</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span> <span class="token number">244</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">191</span><span class="token punctuation">;</span> <span class="token number">245</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">230</span><span class="token punctuation">;</span> <span class="token number">246</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">66</span><span class="token punctuation">;</span> <span class="token number">247</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">104</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">248</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">65</span><span class="token punctuation">;</span> <span class="token number">249</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">153</span><span class="token punctuation">;</span> <span class="token number">250</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">;</span> <span class="token number">251</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token number">252</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">176</span><span class="token punctuation">;</span> <span class="token number">253</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">84</span><span class="token punctuation">;</span> <span class="token number">254</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">187</span><span class="token punctuation">;</span> <span class="token number">255</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">endcase</span>
</span><span class="code-line">  <span class="token keyword">endfunction</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> y <span class="token operator">=</span> <span class="token operator">{</span><span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token comment">//      InvSubBytes        //</span>
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token keyword">module</span> InvSubBytes <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> y<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> S<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token number">0</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">82</span><span class="token punctuation">;</span>   <span class="token number">1</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">9</span><span class="token punctuation">;</span>   <span class="token number">2</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">106</span><span class="token punctuation">;</span>   <span class="token number">3</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">213</span><span class="token punctuation">;</span>   <span class="token number">4</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">;</span>   <span class="token number">5</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">54</span><span class="token punctuation">;</span>   <span class="token number">6</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">165</span><span class="token punctuation">;</span>   <span class="token number">7</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token number">8</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">191</span><span class="token punctuation">;</span>   <span class="token number">9</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>  <span class="token number">10</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">163</span><span class="token punctuation">;</span>  <span class="token number">11</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">158</span><span class="token punctuation">;</span>  <span class="token number">12</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">129</span><span class="token punctuation">;</span>  <span class="token number">13</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">243</span><span class="token punctuation">;</span>  <span class="token number">14</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">215</span><span class="token punctuation">;</span>  <span class="token number">15</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">251</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">16</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">124</span><span class="token punctuation">;</span>  <span class="token number">17</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">227</span><span class="token punctuation">;</span>  <span class="token number">18</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">57</span><span class="token punctuation">;</span>  <span class="token number">19</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">;</span>  <span class="token number">20</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">155</span><span class="token punctuation">;</span>  <span class="token number">21</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">47</span><span class="token punctuation">;</span>  <span class="token number">22</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">;</span>  <span class="token number">23</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">135</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">24</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">;</span>  <span class="token number">25</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">142</span><span class="token punctuation">;</span>  <span class="token number">26</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">;</span>  <span class="token number">27</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">68</span><span class="token punctuation">;</span>  <span class="token number">28</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">196</span><span class="token punctuation">;</span>  <span class="token number">29</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">222</span><span class="token punctuation">;</span>  <span class="token number">30</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">233</span><span class="token punctuation">;</span>  <span class="token number">31</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">203</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">32</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">84</span><span class="token punctuation">;</span>  <span class="token number">33</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span>  <span class="token number">34</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">148</span><span class="token punctuation">;</span>  <span class="token number">35</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>  <span class="token number">36</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">166</span><span class="token punctuation">;</span>  <span class="token number">37</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">194</span><span class="token punctuation">;</span>  <span class="token number">38</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>  <span class="token number">39</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">61</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">40</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">238</span><span class="token punctuation">;</span>  <span class="token number">41</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">76</span><span class="token punctuation">;</span>  <span class="token number">42</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">149</span><span class="token punctuation">;</span>  <span class="token number">43</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>  <span class="token number">44</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">66</span><span class="token punctuation">;</span>  <span class="token number">45</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">;</span>  <span class="token number">46</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">195</span><span class="token punctuation">;</span>  <span class="token number">47</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">78</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">48</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">8</span><span class="token punctuation">;</span>  <span class="token number">49</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">46</span><span class="token punctuation">;</span>  <span class="token number">50</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">161</span><span class="token punctuation">;</span>  <span class="token number">51</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">102</span><span class="token punctuation">;</span>  <span class="token number">52</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>  <span class="token number">53</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">217</span><span class="token punctuation">;</span>  <span class="token number">54</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">36</span><span class="token punctuation">;</span>  <span class="token number">55</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">178</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">56</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">118</span><span class="token punctuation">;</span>  <span class="token number">57</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">91</span><span class="token punctuation">;</span>  <span class="token number">58</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">162</span><span class="token punctuation">;</span>  <span class="token number">59</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">73</span><span class="token punctuation">;</span>  <span class="token number">60</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">109</span><span class="token punctuation">;</span>  <span class="token number">61</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">139</span><span class="token punctuation">;</span>  <span class="token number">62</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">209</span><span class="token punctuation">;</span>  <span class="token number">63</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">37</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">64</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">114</span><span class="token punctuation">;</span>  <span class="token number">65</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">248</span><span class="token punctuation">;</span>  <span class="token number">66</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">246</span><span class="token punctuation">;</span>  <span class="token number">67</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>  <span class="token number">68</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">134</span><span class="token punctuation">;</span>  <span class="token number">69</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">104</span><span class="token punctuation">;</span>  <span class="token number">70</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">152</span><span class="token punctuation">;</span>  <span class="token number">71</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">72</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">212</span><span class="token punctuation">;</span>  <span class="token number">73</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">164</span><span class="token punctuation">;</span>  <span class="token number">74</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">92</span><span class="token punctuation">;</span>  <span class="token number">75</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">204</span><span class="token punctuation">;</span>  <span class="token number">76</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">93</span><span class="token punctuation">;</span>  <span class="token number">77</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">101</span><span class="token punctuation">;</span>  <span class="token number">78</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">182</span><span class="token punctuation">;</span>  <span class="token number">79</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">146</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">80</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">108</span><span class="token punctuation">;</span>  <span class="token number">81</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">112</span><span class="token punctuation">;</span>  <span class="token number">82</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">;</span>  <span class="token number">83</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>  <span class="token number">84</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">253</span><span class="token punctuation">;</span>  <span class="token number">85</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">237</span><span class="token punctuation">;</span>  <span class="token number">86</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">185</span><span class="token punctuation">;</span>  <span class="token number">87</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">218</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">88</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">94</span><span class="token punctuation">;</span>  <span class="token number">89</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>  <span class="token number">90</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">;</span>  <span class="token number">91</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">87</span><span class="token punctuation">;</span>  <span class="token number">92</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">167</span><span class="token punctuation">;</span>  <span class="token number">93</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">141</span><span class="token punctuation">;</span>  <span class="token number">94</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">157</span><span class="token punctuation">;</span>  <span class="token number">95</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">132</span><span class="token punctuation">;</span>
</span><span class="code-line">       <span class="token number">96</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">;</span>  <span class="token number">97</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">216</span><span class="token punctuation">;</span>  <span class="token number">98</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">171</span><span class="token punctuation">;</span>  <span class="token number">99</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">100</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">140</span><span class="token punctuation">;</span> <span class="token number">101</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">188</span><span class="token punctuation">;</span> <span class="token number">102</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">211</span><span class="token punctuation">;</span> <span class="token number">103</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">104</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">247</span><span class="token punctuation">;</span> <span class="token number">105</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">228</span><span class="token punctuation">;</span> <span class="token number">106</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">88</span><span class="token punctuation">;</span> <span class="token number">107</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">5</span><span class="token punctuation">;</span> <span class="token number">108</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">184</span><span class="token punctuation">;</span> <span class="token number">109</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">179</span><span class="token punctuation">;</span> <span class="token number">110</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">69</span><span class="token punctuation">;</span> <span class="token number">111</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">6</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">112</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">208</span><span class="token punctuation">;</span> <span class="token number">113</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">44</span><span class="token punctuation">;</span> <span class="token number">114</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token number">115</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">143</span><span class="token punctuation">;</span> <span class="token number">116</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">202</span><span class="token punctuation">;</span> <span class="token number">117</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span> <span class="token number">118</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token number">119</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">2</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">120</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">193</span><span class="token punctuation">;</span> <span class="token number">121</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">175</span><span class="token punctuation">;</span> <span class="token number">122</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">189</span><span class="token punctuation">;</span> <span class="token number">123</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">124</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">125</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span> <span class="token number">126</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">138</span><span class="token punctuation">;</span> <span class="token number">127</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">107</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">128</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">58</span><span class="token punctuation">;</span> <span class="token number">129</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">145</span><span class="token punctuation">;</span> <span class="token number">130</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span> <span class="token number">131</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">65</span><span class="token punctuation">;</span> <span class="token number">132</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">79</span><span class="token punctuation">;</span> <span class="token number">133</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">103</span><span class="token punctuation">;</span> <span class="token number">134</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">220</span><span class="token punctuation">;</span> <span class="token number">135</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">234</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">136</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">151</span><span class="token punctuation">;</span> <span class="token number">137</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">242</span><span class="token punctuation">;</span> <span class="token number">138</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">207</span><span class="token punctuation">;</span> <span class="token number">139</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">206</span><span class="token punctuation">;</span> <span class="token number">140</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">240</span><span class="token punctuation">;</span> <span class="token number">141</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">;</span> <span class="token number">142</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">230</span><span class="token punctuation">;</span> <span class="token number">143</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">115</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">144</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">;</span> <span class="token number">145</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">172</span><span class="token punctuation">;</span> <span class="token number">146</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">116</span><span class="token punctuation">;</span> <span class="token number">147</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">34</span><span class="token punctuation">;</span> <span class="token number">148</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">231</span><span class="token punctuation">;</span> <span class="token number">149</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">173</span><span class="token punctuation">;</span> <span class="token number">150</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">53</span><span class="token punctuation">;</span> <span class="token number">151</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">133</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">152</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">226</span><span class="token punctuation">;</span> <span class="token number">153</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">249</span><span class="token punctuation">;</span> <span class="token number">154</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">55</span><span class="token punctuation">;</span> <span class="token number">155</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">232</span><span class="token punctuation">;</span> <span class="token number">156</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">;</span> <span class="token number">157</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">117</span><span class="token punctuation">;</span> <span class="token number">158</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">223</span><span class="token punctuation">;</span> <span class="token number">159</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">110</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">160</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">71</span><span class="token punctuation">;</span> <span class="token number">161</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">241</span><span class="token punctuation">;</span> <span class="token number">162</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">26</span><span class="token punctuation">;</span> <span class="token number">163</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">113</span><span class="token punctuation">;</span> <span class="token number">164</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span> <span class="token number">165</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">41</span><span class="token punctuation">;</span> <span class="token number">166</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">197</span><span class="token punctuation">;</span> <span class="token number">167</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">137</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">168</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">111</span><span class="token punctuation">;</span> <span class="token number">169</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">183</span><span class="token punctuation">;</span> <span class="token number">170</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">98</span><span class="token punctuation">;</span> <span class="token number">171</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span> <span class="token number">172</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">170</span><span class="token punctuation">;</span> <span class="token number">173</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">;</span> <span class="token number">174</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">190</span><span class="token punctuation">;</span> <span class="token number">175</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">176</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">252</span><span class="token punctuation">;</span> <span class="token number">177</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">86</span><span class="token punctuation">;</span> <span class="token number">178</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">62</span><span class="token punctuation">;</span> <span class="token number">179</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">;</span> <span class="token number">180</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">198</span><span class="token punctuation">;</span> <span class="token number">181</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">210</span><span class="token punctuation">;</span> <span class="token number">182</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">121</span><span class="token punctuation">;</span> <span class="token number">183</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">184</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">154</span><span class="token punctuation">;</span> <span class="token number">185</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">219</span><span class="token punctuation">;</span> <span class="token number">186</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">192</span><span class="token punctuation">;</span> <span class="token number">187</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">254</span><span class="token punctuation">;</span> <span class="token number">188</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">;</span> <span class="token number">189</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">205</span><span class="token punctuation">;</span> <span class="token number">190</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span> <span class="token number">191</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">244</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">192</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">31</span><span class="token punctuation">;</span> <span class="token number">193</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">221</span><span class="token punctuation">;</span> <span class="token number">194</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">168</span><span class="token punctuation">;</span> <span class="token number">195</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">51</span><span class="token punctuation">;</span> <span class="token number">196</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">136</span><span class="token punctuation">;</span> <span class="token number">197</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">7</span><span class="token punctuation">;</span> <span class="token number">198</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">199</span><span class="token punctuation">;</span> <span class="token number">199</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">200</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">177</span><span class="token punctuation">;</span> <span class="token number">201</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span> <span class="token number">202</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span> <span class="token number">203</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">89</span><span class="token punctuation">;</span> <span class="token number">204</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">39</span><span class="token punctuation">;</span> <span class="token number">205</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">;</span> <span class="token number">206</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">236</span><span class="token punctuation">;</span> <span class="token number">207</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">95</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">208</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">96</span><span class="token punctuation">;</span> <span class="token number">209</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">81</span><span class="token punctuation">;</span> <span class="token number">210</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">127</span><span class="token punctuation">;</span> <span class="token number">211</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">169</span><span class="token punctuation">;</span> <span class="token number">212</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span> <span class="token number">213</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">181</span><span class="token punctuation">;</span> <span class="token number">214</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">74</span><span class="token punctuation">;</span> <span class="token number">215</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">216</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">;</span> <span class="token number">217</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">229</span><span class="token punctuation">;</span> <span class="token number">218</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">122</span><span class="token punctuation">;</span> <span class="token number">219</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">159</span><span class="token punctuation">;</span> <span class="token number">220</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">147</span><span class="token punctuation">;</span> <span class="token number">221</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">;</span> <span class="token number">222</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">156</span><span class="token punctuation">;</span> <span class="token number">223</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">239</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">224</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">160</span><span class="token punctuation">;</span> <span class="token number">225</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">224</span><span class="token punctuation">;</span> <span class="token number">226</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">59</span><span class="token punctuation">;</span> <span class="token number">227</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">77</span><span class="token punctuation">;</span> <span class="token number">228</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">174</span><span class="token punctuation">;</span> <span class="token number">229</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span> <span class="token number">230</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">245</span><span class="token punctuation">;</span> <span class="token number">231</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">176</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">232</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span> <span class="token number">233</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">235</span><span class="token punctuation">;</span> <span class="token number">234</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">187</span><span class="token punctuation">;</span> <span class="token number">235</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span> <span class="token number">236</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">131</span><span class="token punctuation">;</span> <span class="token number">237</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">83</span><span class="token punctuation">;</span> <span class="token number">238</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">153</span><span class="token punctuation">;</span> <span class="token number">239</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">240</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span> <span class="token number">241</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">43</span><span class="token punctuation">;</span> <span class="token number">242</span><span class="token punctuation">:</span>S<span class="token operator">=</span>  <span class="token number">4</span><span class="token punctuation">;</span> <span class="token number">243</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">126</span><span class="token punctuation">;</span> <span class="token number">244</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">186</span><span class="token punctuation">;</span> <span class="token number">245</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">119</span><span class="token punctuation">;</span> <span class="token number">246</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">214</span><span class="token punctuation">;</span> <span class="token number">247</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">248</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">225</span><span class="token punctuation">;</span> <span class="token number">249</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">105</span><span class="token punctuation">;</span> <span class="token number">250</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token number">251</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span> <span class="token number">252</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">85</span><span class="token punctuation">;</span> <span class="token number">253</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">33</span><span class="token punctuation">;</span> <span class="token number">254</span><span class="token punctuation">:</span>S<span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span> <span class="token number">255</span><span class="token punctuation">:</span>S<span class="token operator">=</span><span class="token number">125</span><span class="token punctuation">;</span> 
</span><span class="code-line">    <span class="token keyword">endcase</span>
</span><span class="code-line">  <span class="token keyword">endfunction</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> y <span class="token operator">=</span> <span class="token operator">{</span><span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token comment">//       MixColumns        //</span>
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">MixColumns</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  x<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  y<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> a3<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> a1<span class="token punctuation">,</span> a0<span class="token punctuation">,</span> b3<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b0<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> a3 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> a2 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> a1 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> a0 <span class="token operator">=</span> x<span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> b3 <span class="token operator">=</span> a3 <span class="token operator">^</span> a2<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> b2 <span class="token operator">=</span> a2 <span class="token operator">^</span> a1<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> b1 <span class="token operator">=</span> a1 <span class="token operator">^</span> a0<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> b0 <span class="token operator">=</span> a0 <span class="token operator">^</span> a3<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> y <span class="token operator">=</span> <span class="token operator">{</span>a2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a2<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a2<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a0<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a0<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a0<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">              a1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token comment">//     InvMixColumns       //</span>
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">InvMixColumns</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  x<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  y<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> a3<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> a1<span class="token punctuation">,</span> a0<span class="token punctuation">,</span> b3<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b0<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> c3<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c0<span class="token punctuation">,</span> d3<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> d0<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> a3 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> a2 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> a1 <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> a0 <span class="token operator">=</span> x<span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> b3 <span class="token operator">=</span> a3 <span class="token operator">^</span> a2<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> b2 <span class="token operator">=</span> a2 <span class="token operator">^</span> a1<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> b1 <span class="token operator">=</span> a1 <span class="token operator">^</span> a0<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> b0 <span class="token operator">=</span> a0 <span class="token operator">^</span> a3<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> c3 <span class="token operator">=</span> <span class="token operator">{</span>a2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a2<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a2<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> c2 <span class="token operator">=</span> <span class="token operator">{</span>a3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> c1 <span class="token operator">=</span> <span class="token operator">{</span>a0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a0<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a0<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a0<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> c0 <span class="token operator">=</span> <span class="token operator">{</span>a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               a1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> b0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> d3 <span class="token operator">=</span> <span class="token operator">{</span>c3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c3<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> c3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> c3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> c3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               c3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> c3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> c3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c3<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> c3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c3<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> d2 <span class="token operator">=</span> <span class="token operator">{</span>c2<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> c2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> c2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> c2<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               c2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> c2<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> c2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> c2<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> d1 <span class="token operator">=</span> <span class="token operator">{</span>c1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> c1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> c1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> c1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               c1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> c1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> c1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> c1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> d0 <span class="token operator">=</span> <span class="token operator">{</span>c0<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c0<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> c0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c0<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> c0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> c0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               c0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> c0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> c0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c0<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^</span> c0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c0<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> y  <span class="token operator">=</span> <span class="token operator">{</span>d3 <span class="token operator">^</span> d1 <span class="token operator">^</span> c3<span class="token punctuation">,</span> d2 <span class="token operator">^</span> d0 <span class="token operator">^</span> c2<span class="token punctuation">,</span> d3 <span class="token operator">^</span> d1 <span class="token operator">^</span> c1<span class="token punctuation">,</span> d2 <span class="token operator">^</span> d0 <span class="token operator">^</span> c0<span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token comment">//     Encryotion Core     //</span>
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">EncCore</span><span class="token punctuation">(</span>di<span class="token punctuation">,</span> ki<span class="token punctuation">,</span> Rrg<span class="token punctuation">,</span> <span class="token keyword">do</span><span class="token punctuation">,</span> ko<span class="token punctuation">)</span><span class="token punctuation">;</span>   										
</span><span class="code-line">  <span class="token comment">//参数依次为128位明文、轮密钥、当前加密轮数、下一轮状态矩阵、下一轮轮密钥</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> di<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ki<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>   Rrg<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">do</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ko<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> sb<span class="token punctuation">,</span> sr<span class="token punctuation">,</span> mx<span class="token punctuation">;</span><span class="token comment">//中间值，依次保存状态矩阵字节代换、行移位、列混合后的结果</span>
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  so<span class="token punctuation">;</span><span class="token comment">//中间值，保存密钥扩展中函数T行移位与字节代换后的结果</span>
</span><span class="code-line">
</span><span class="code-line">  SubBytes SB3 <span class="token punctuation">(</span>di<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  SubBytes SB2 <span class="token punctuation">(</span>di<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  SubBytes SB1 <span class="token punctuation">(</span>di<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  SubBytes SB0 <span class="token punctuation">(</span>di<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> sr <span class="token operator">=</span> <span class="token operator">{</span>sb<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">87</span><span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">47</span><span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span>  <span class="token number">7</span><span class="token punctuation">:</span>  <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               sb<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span> <span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">55</span><span class="token punctuation">:</span> <span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">15</span><span class="token punctuation">:</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span> <span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               sb<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span> <span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">23</span><span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">:</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">71</span><span class="token punctuation">:</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               sb<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">:</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">79</span><span class="token punctuation">:</span> <span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">39</span><span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  MixColumns MX3 <span class="token punctuation">(</span>sr<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mx<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  MixColumns MX2 <span class="token punctuation">(</span>sr<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mx<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  MixColumns MX1 <span class="token punctuation">(</span>sr<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mx<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  MixColumns MX0 <span class="token punctuation">(</span>sr<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mx<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> <span class="token keyword">do</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Rrg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">?</span> sr<span class="token punctuation">:</span> mx<span class="token punctuation">)</span> <span class="token operator">^</span> ki<span class="token punctuation">;</span><span class="token comment">//判断是否为第10轮，若是，则跳过列混合使用sr轮密钥加，否则使用mx轮密钥加</span>
</span><span class="code-line">  <span class="token comment">//以上过程完成一轮加密获得下一轮状态矩阵do</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> rcon<span class="token punctuation">;</span><span class="token comment">//生成密钥扩展中的T函数中的rcon[j]</span>
</span><span class="code-line">  <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span><span class="token comment">//x对应当前加密轮数</span>
</span><span class="code-line">    <span class="token keyword">casex</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token number">10'bxxxxxxxxx1</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h01</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxxxxxx1x</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h02</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxxxxx1xx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h04</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxxxx1xxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h08</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxxx1xxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h10</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxx1xxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h20</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxx1xxxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h40</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxx1xxxxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h80</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bx1xxxxxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h1b</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'b1xxxxxxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h36</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">endcase</span>
</span><span class="code-line">  <span class="token keyword">endfunction</span>
</span><span class="code-line">
</span><span class="code-line">  SubBytes SBK <span class="token punctuation">(</span><span class="token operator">{</span>ki<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ki<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ki<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ki<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">,</span> so<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token comment">//字循环后S盒字节代换，结果保存在so中</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> ko<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span> <span class="token operator">=</span> ki<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token operator">{</span>so<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">rcon</span><span class="token punctuation">(</span>Rrg<span class="token punctuation">)</span><span class="token punctuation">,</span> so<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span><span class="token comment">//对于W[4i]的扩展</span>
</span><span class="code-line">  <span class="token keyword">assign</span> ko<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> ki<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">^</span> ko<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> ko<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> ki<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">^</span> ko<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> ko<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> ki<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> ko<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">	<span class="token comment">//以上过程生成下一轮加密的轮密钥</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token comment">//     Decryotion Core     //</span>
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">DecCore</span><span class="token punctuation">(</span>di<span class="token punctuation">,</span> ki<span class="token punctuation">,</span> Rrg<span class="token punctuation">,</span> <span class="token keyword">do</span><span class="token punctuation">,</span> ko<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> di<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ki<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>   Rrg<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">do</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ko<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> sb<span class="token punctuation">,</span> sr<span class="token punctuation">,</span> mx<span class="token punctuation">,</span> dx<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>  so<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  InvMixColumns MX3 <span class="token punctuation">(</span>di<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mx<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  InvMixColumns MX2 <span class="token punctuation">(</span>di<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mx<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  InvMixColumns MX1 <span class="token punctuation">(</span>di<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mx<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  InvMixColumns MX0 <span class="token punctuation">(</span>di<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mx<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> dx <span class="token operator">=</span> <span class="token punctuation">(</span>Rrg<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">?</span> di<span class="token punctuation">:</span> mx<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> sr <span class="token operator">=</span> <span class="token operator">{</span>dx<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">120</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span> <span class="token number">23</span><span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span> <span class="token number">47</span><span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span> <span class="token number">71</span><span class="token punctuation">:</span> <span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               dx<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span> <span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">:</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span> <span class="token number">15</span><span class="token punctuation">:</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span> <span class="token number">39</span><span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               dx<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span> <span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span> <span class="token number">87</span><span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">:</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span>  <span class="token number">7</span><span class="token punctuation">:</span>  <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">               dx<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span> <span class="token number">55</span><span class="token punctuation">:</span> <span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span> <span class="token number">79</span><span class="token punctuation">:</span> <span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dx<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">:</span> <span class="token number">96</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  InvSubBytes SB3 <span class="token punctuation">(</span>sr<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  InvSubBytes SB2 <span class="token punctuation">(</span>sr<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  InvSubBytes SB1 <span class="token punctuation">(</span>sr<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  InvSubBytes SB0 <span class="token punctuation">(</span>sr<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sb<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> <span class="token keyword">do</span> <span class="token operator">=</span> sb <span class="token operator">^</span> ki<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> rcon<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">casex</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token number">10'bxxxxxxxxx1</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h01</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxxxxxx1x</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h02</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxxxxx1xx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h04</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxxxx1xxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h08</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxxx1xxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h10</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxxx1xxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h20</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxxx1xxxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h40</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bxx1xxxxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h80</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'bx1xxxxxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h1b</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token number">10'b1xxxxxxxxx</span><span class="token punctuation">:</span> rcon <span class="token operator">=</span> <span class="token number">8'h36</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">endcase</span>
</span><span class="code-line">  <span class="token keyword">endfunction</span>
</span><span class="code-line">
</span><span class="code-line">  SubBytes SBK <span class="token punctuation">(</span><span class="token operator">{</span>ko<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ko<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ko<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ko<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">,</span> so<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> ko<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span> <span class="token operator">=</span> ki<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token operator">{</span>so<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">rcon</span><span class="token punctuation">(</span>Rrg<span class="token punctuation">)</span><span class="token punctuation">,</span> so<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> ko<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> ki<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">^</span> ki<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> ko<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> ki<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">^</span> ki<span class="token punctuation">[</span> <span class="token number">95</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> ko<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> ki<span class="token punctuation">[</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> ki<span class="token punctuation">[</span> <span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token comment">//   AES for encryption    //</span>
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">AES_ENC</span><span class="token punctuation">(</span>Din<span class="token punctuation">,</span> Key<span class="token punctuation">,</span> Dout<span class="token punctuation">,</span> Drdy<span class="token punctuation">,</span> Krdy<span class="token punctuation">,</span> RSTn<span class="token punctuation">,</span> EN<span class="token punctuation">,</span> CLK<span class="token punctuation">,</span> BSY<span class="token punctuation">,</span> Dvld<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Din<span class="token punctuation">;</span>  <span class="token comment">// Data input</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Key<span class="token punctuation">;</span>  <span class="token comment">// Key input</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Dout<span class="token punctuation">;</span> <span class="token comment">// Data output</span>
</span><span class="code-line">  <span class="token keyword">input</span>  Drdy<span class="token punctuation">;</span>         <span class="token comment">// Data input ready</span>
</span><span class="code-line">  <span class="token keyword">input</span>  Krdy<span class="token punctuation">;</span>         <span class="token comment">// Key input ready</span>
</span><span class="code-line">  <span class="token keyword">input</span>  RSTn<span class="token punctuation">;</span>         <span class="token comment">// Reset (Low active)</span>
</span><span class="code-line">  <span class="token keyword">input</span>  EN<span class="token punctuation">;</span>           <span class="token comment">// AES circuit enable</span>
</span><span class="code-line">  <span class="token keyword">input</span>  CLK<span class="token punctuation">;</span>          <span class="token comment">// System clock</span>
</span><span class="code-line">  <span class="token keyword">output</span> BSY<span class="token punctuation">;</span>          <span class="token comment">// Busy signal</span>
</span><span class="code-line">  <span class="token keyword">output</span> Dvld<span class="token punctuation">;</span>         <span class="token comment">// Data output valid</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Drg<span class="token punctuation">;</span>    <span class="token comment">// Data register</span>
</span><span class="code-line">  <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Krg<span class="token punctuation">;</span>    <span class="token comment">// Key register</span>
</span><span class="code-line">  <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> KrgX<span class="token punctuation">;</span>   <span class="token comment">// Temporary key Register</span>
</span><span class="code-line">  <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>   Rrg<span class="token punctuation">;</span>    <span class="token comment">// Round counter</span>
</span><span class="code-line">  <span class="token keyword">reg</span>  Dvldrg<span class="token punctuation">,</span> BSYrg<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Dnext<span class="token punctuation">,</span> Knext<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  EncCore EC <span class="token punctuation">(</span>Drg<span class="token punctuation">,</span> KrgX<span class="token punctuation">,</span> Rrg<span class="token punctuation">,</span> Dnext<span class="token punctuation">,</span> Knext<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> Dvld <span class="token operator">=</span> Dvldrg<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> Dout <span class="token operator">=</span> Drg<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> BSY  <span class="token operator">=</span> BSYrg<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> CLK<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>RSTn <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">      Rrg    <span class="token operator">&#x3C;=</span> <span class="token number">10'b0000000001</span><span class="token punctuation">;</span>
</span><span class="code-line">      Dvldrg <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">      BSYrg  <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">end</span>
</span><span class="code-line">    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>EN <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">       <span class="token keyword">if</span> <span class="token punctuation">(</span>BSYrg <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>Krdy <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">          Krg    <span class="token operator">&#x3C;=</span> Key<span class="token punctuation">;</span>
</span><span class="code-line">          KrgX   <span class="token operator">&#x3C;=</span> Key<span class="token punctuation">;</span>
</span><span class="code-line">          Dvldrg <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Drdy <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">          Rrg    <span class="token operator">&#x3C;=</span> <span class="token operator">{</span>Rrg<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Rrg<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">          KrgX   <span class="token operator">&#x3C;=</span> Knext<span class="token punctuation">;</span>
</span><span class="code-line">          Drg    <span class="token operator">&#x3C;=</span> Din <span class="token operator">^</span> Krg<span class="token punctuation">;</span>
</span><span class="code-line">          Dvldrg <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">          BSYrg  <span class="token operator">&#x3C;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">      <span class="token keyword">end</span>
</span><span class="code-line">      <span class="token keyword">else</span> <span class="token keyword">begin</span>
</span><span class="code-line">        Drg <span class="token operator">&#x3C;=</span> Dnext<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>Rrg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">          KrgX   <span class="token operator">&#x3C;=</span> Krg<span class="token punctuation">;</span>
</span><span class="code-line">          Dvldrg <span class="token operator">&#x3C;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">          BSYrg  <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">        <span class="token keyword">else</span> <span class="token keyword">begin</span>
</span><span class="code-line">          Rrg    <span class="token operator">&#x3C;=</span> <span class="token operator">{</span>Rrg<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Rrg<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">          KrgX   <span class="token operator">&#x3C;=</span> Knext<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">      <span class="token keyword">end</span>
</span><span class="code-line">    <span class="token keyword">end</span>
</span><span class="code-line">  <span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token comment">//   AES for decryption    //</span>
</span><span class="code-line"><span class="token comment">/////////////////////////////</span>
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">AES_DEC</span><span class="token punctuation">(</span>Din<span class="token punctuation">,</span> Key<span class="token punctuation">,</span> Dout<span class="token punctuation">,</span> Drdy<span class="token punctuation">,</span> Krdy<span class="token punctuation">,</span> RSTn<span class="token punctuation">,</span> EN<span class="token punctuation">,</span> CLK<span class="token punctuation">,</span> BSY<span class="token punctuation">,</span> Dvld<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Din<span class="token punctuation">;</span>  <span class="token comment">// Data input</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Key<span class="token punctuation">;</span>  <span class="token comment">// Key input</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Dout<span class="token punctuation">;</span> <span class="token comment">// Data output</span>
</span><span class="code-line">  <span class="token keyword">input</span>  Drdy<span class="token punctuation">;</span>         <span class="token comment">// Data input ready</span>
</span><span class="code-line">  <span class="token keyword">input</span>  Krdy<span class="token punctuation">;</span>         <span class="token comment">// Key input ready</span>
</span><span class="code-line">  <span class="token keyword">input</span>  RSTn<span class="token punctuation">;</span>         <span class="token comment">// Reset (Low active)</span>
</span><span class="code-line">  <span class="token keyword">input</span>  EN<span class="token punctuation">;</span>           <span class="token comment">// AES circuit enable</span>
</span><span class="code-line">  <span class="token keyword">input</span>  CLK<span class="token punctuation">;</span>          <span class="token comment">// System clock</span>
</span><span class="code-line">  <span class="token keyword">output</span> BSY<span class="token punctuation">;</span>          <span class="token comment">// Busy signal</span>
</span><span class="code-line">  <span class="token keyword">output</span> Dvld<span class="token punctuation">;</span>         <span class="token comment">// Data output valid</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Drg<span class="token punctuation">;</span>    <span class="token comment">// Data register</span>
</span><span class="code-line">  <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Krg<span class="token punctuation">;</span>    <span class="token comment">// Key register</span>
</span><span class="code-line">  <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> KrgX<span class="token punctuation">;</span>   <span class="token comment">// Temporary key Register</span>
</span><span class="code-line">  <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>   Rrg<span class="token punctuation">;</span>    <span class="token comment">// Round counter</span>
</span><span class="code-line">  <span class="token keyword">reg</span>  Dvldrg<span class="token punctuation">,</span> BSYrg<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> Dnext<span class="token punctuation">,</span> Knext<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  DecCore DC <span class="token punctuation">(</span>Drg<span class="token punctuation">,</span> KrgX<span class="token punctuation">,</span> Rrg<span class="token punctuation">,</span> Dnext<span class="token punctuation">,</span> Knext<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> Dvld <span class="token operator">=</span> Dvldrg<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> Dout <span class="token operator">=</span> Drg<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> BSY  <span class="token operator">=</span> BSYrg<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> CLK<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>RSTn <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">      Rrg    <span class="token operator">&#x3C;=</span> <span class="token number">10'b1000000000</span><span class="token punctuation">;</span>
</span><span class="code-line">      Dvldrg <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">      BSYrg  <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">end</span>
</span><span class="code-line">    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>EN <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>BSYrg <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>Krdy <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">          Krg    <span class="token operator">&#x3C;=</span> Key<span class="token punctuation">;</span>
</span><span class="code-line">          KrgX   <span class="token operator">&#x3C;=</span> Key<span class="token punctuation">;</span>
</span><span class="code-line">          Dvldrg <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Drdy <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">          KrgX   <span class="token operator">&#x3C;=</span> Knext<span class="token punctuation">;</span>
</span><span class="code-line">          Drg    <span class="token operator">&#x3C;=</span> Din <span class="token operator">^</span> Krg<span class="token punctuation">;</span>
</span><span class="code-line">          Rrg <span class="token operator">&#x3C;=</span> <span class="token operator">{</span>Rrg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Rrg<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">          Dvldrg <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">          BSYrg  <span class="token operator">&#x3C;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">      <span class="token keyword">end</span>
</span><span class="code-line">      <span class="token keyword">else</span> <span class="token keyword">begin</span>
</span><span class="code-line">        Drg <span class="token operator">&#x3C;=</span> Dnext<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>Rrg<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">          KrgX   <span class="token operator">&#x3C;=</span> Krg<span class="token punctuation">;</span>
</span><span class="code-line">          Dvldrg <span class="token operator">&#x3C;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">          BSYrg  <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">        <span class="token keyword">else</span> <span class="token keyword">begin</span>
</span><span class="code-line">          Rrg    <span class="token operator">&#x3C;=</span> <span class="token operator">{</span>Rrg<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Rrg<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">          KrgX   <span class="token operator">&#x3C;=</span> Knext<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">      <span class="token keyword">end</span>
</span><span class="code-line">    <span class="token keyword">end</span>
</span><span class="code-line">  <span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span></code></pre>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="a51"><a aria-hidden="true" tabindex="-1" href="#a51"><span class="icon icon-link"></span></a>A51</h3><div class="wrap-body">
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">module</span> <span class="token function">LFSR</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>key_next<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> key<span class="token punctuation">;</span>         <span class="token comment">// 输入原始密钥</span>
</span><span class="code-line">  <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> key_next<span class="token punctuation">;</span>    <span class="token comment">// 输出下一个密钥</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>x<span class="token punctuation">;</span>            <span class="token comment">// lfsr1</span>
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>y<span class="token punctuation">;</span>            <span class="token comment">// lfsr2</span>
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>z<span class="token punctuation">;</span>            <span class="token comment">// lfsr3</span>
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>x_next<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>y_next<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">wire</span>   <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>z_next<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">wire</span>   majority<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">assign</span> x<span class="token operator">=</span>key<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment">// 低位是 x</span>
</span><span class="code-line">  <span class="token keyword">assign</span> y<span class="token operator">=</span>key<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">assign</span> z<span class="token operator">=</span>key<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">// 高位是 z</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token function">maj</span><span class="token punctuation">(</span><span class="token keyword">input</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    maj <span class="token operator">=</span> x<span class="token operator">&#x26;</span>y <span class="token operator">|</span> x<span class="token operator">&#x26;</span>z <span class="token operator">|</span> y<span class="token operator">&#x26;</span>z<span class="token punctuation">;</span>   <span class="token comment">// 计算多数位</span>
</span><span class="code-line">  <span class="token keyword">endfunction</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token function">lfsr1</span><span class="token punctuation">(</span><span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">begin</span>
</span><span class="code-line">    <span class="token function">case</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token number">0</span><span class="token punctuation">:</span>lfsr1<span class="token operator">={</span>in<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">^</span>in<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">^</span>in<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">^</span>in<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>   <span class="token comment">// 如果最高位为0，进行位运算</span>
</span><span class="code-line">      <span class="token number">1</span><span class="token punctuation">:</span>lfsr1<span class="token operator">=</span>in<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment">// 如果最高位为1，保持不变</span>
</span><span class="code-line">    <span class="token keyword">endcase</span>
</span><span class="code-line">  <span class="token keyword">end</span>
</span><span class="code-line">  <span class="token keyword">endfunction</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token function">lfsr2</span><span class="token punctuation">(</span><span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">begin</span>
</span><span class="code-line">    <span class="token function">case</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token number">0</span><span class="token punctuation">:</span>lfsr2<span class="token operator">={</span>in<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">^</span>in<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>   <span class="token comment">// 如果最高位为0，进行位运算</span>
</span><span class="code-line">      <span class="token number">1</span><span class="token punctuation">:</span>lfsr2<span class="token operator">=</span>in<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment">// 如果最高位为1，保持不变</span>
</span><span class="code-line">    <span class="token keyword">endcase</span>
</span><span class="code-line">  <span class="token keyword">end</span>
</span><span class="code-line">  <span class="token keyword">endfunction</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token function">lfsr3</span><span class="token punctuation">(</span><span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">begin</span>
</span><span class="code-line">    <span class="token function">case</span><span class="token punctuation">(</span>in<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token number">0</span><span class="token punctuation">:</span>lfsr3<span class="token operator">={</span>in<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> in<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">^</span>in<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">^</span>in<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">^</span>in<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>   <span class="token comment">// 如果最高位为0，进行位运算</span>
</span><span class="code-line">      <span class="token number">1</span><span class="token punctuation">:</span>lfsr3<span class="token operator">=</span>in<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment">// 如果最高位为1，保持不变</span>
</span><span class="code-line">    <span class="token keyword">endcase</span>
</span><span class="code-line">  <span class="token keyword">end</span>
</span><span class="code-line">  <span class="token keyword">endfunction</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword">assign</span> majority <span class="token operator">=</span> <span class="token function">maj</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>z<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 计算多数位</span>
</span><span class="code-line">  <span class="token keyword">assign</span> x_next <span class="token operator">=</span> <span class="token function">lfsr1</span><span class="token punctuation">(</span><span class="token operator">{</span>majority<span class="token operator">^</span>x<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 计算下一个 x</span>
</span><span class="code-line">  <span class="token keyword">assign</span> y_next <span class="token operator">=</span> <span class="token function">lfsr2</span><span class="token punctuation">(</span><span class="token operator">{</span>majority<span class="token operator">^</span>y<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 计算下一个 y</span>
</span><span class="code-line">  <span class="token keyword">assign</span> z_next <span class="token operator">=</span> <span class="token function">lfsr3</span><span class="token punctuation">(</span><span class="token operator">{</span>majority<span class="token operator">^</span>z<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> z<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 计算下一个 z</span>
</span><span class="code-line">  <span class="token keyword">assign</span> key_next <span class="token operator">=</span> <span class="token operator">{</span>z_next<span class="token punctuation">,</span>y_next<span class="token punctuation">,</span>x_next<span class="token operator">}</span><span class="token punctuation">;</span>         <span class="token comment">// 组合下一个密钥，低位是 x，高位是 z</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">A51</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>plain<span class="token punctuation">,</span>cipher<span class="token punctuation">,</span>clk<span class="token punctuation">,</span>krdy<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>key<span class="token punctuation">;</span>            <span class="token comment">// 原始密钥</span>
</span><span class="code-line"><span class="token keyword">input</span>  plain<span class="token punctuation">;</span>                <span class="token comment">// 明文流</span>
</span><span class="code-line"><span class="token keyword">output</span> cipher<span class="token punctuation">;</span>               <span class="token comment">// 密文流</span>
</span><span class="code-line"><span class="token keyword">input</span>  clk<span class="token punctuation">;</span>                  <span class="token comment">// 系统时钟</span>
</span><span class="code-line"><span class="token keyword">input</span>  krdy<span class="token punctuation">;</span>                 <span class="token comment">// 原始密钥是否就绪</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> kpre<span class="token punctuation">;</span>             <span class="token comment">// 密钥寄存器</span>
</span><span class="code-line"><span class="token keyword">wire</span><span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> knext<span class="token punctuation">;</span>            <span class="token comment">// 下一个密钥</span>
</span><span class="code-line"><span class="token keyword">reg</span> k<span class="token punctuation">;</span>                       <span class="token comment">// 密文流的密钥</span>
</span><span class="code-line">
</span><span class="code-line">LFSR <span class="token function">lfsr</span><span class="token punctuation">(</span>kpre<span class="token punctuation">,</span>knext<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 调用 LFSR 模块</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">assign</span> cipher<span class="token operator">=</span>k<span class="token operator">^</span>plain<span class="token punctuation">;</span>       <span class="token comment">// 计算密文流的密钥</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">  <span class="token function">if</span><span class="token punctuation">(</span>krdy<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>           <span class="token comment">// 如果原始密钥已经就绪，则刷新密钥寄存器</span>
</span><span class="code-line">    kpre <span class="token operator">&#x3C;=</span>key<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">end</span>
</span><span class="code-line">  <span class="token keyword">else</span> <span class="token keyword">begin</span>                  <span class="token comment">// 如果原始密钥未就绪，则使用下一个密钥</span>
</span><span class="code-line">    k <span class="token operator">=</span> knext<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">^</span>knext<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token operator">^</span>knext<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// 计算下一个密文流的密钥</span>
</span><span class="code-line">    kpre <span class="token operator">&#x3C;=</span> knext<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span></code></pre>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="sha256"><a aria-hidden="true" tabindex="-1" href="#sha256"><span class="icon icon-link"></span></a>SHA256</h3><div class="wrap-body">
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token constant">`include</span> <span class="token string">"sha_engine.v"</span>
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">sha256</span><span class="token punctuation">(</span>input_data<span class="token punctuation">,</span>input_valid<span class="token punctuation">,</span>input_ready<span class="token punctuation">,</span>last_word<span class="token punctuation">,</span>clk<span class="token punctuation">,</span>rst<span class="token punctuation">,</span>output_valid<span class="token punctuation">,</span>hash_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>input_data<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">input</span> input_valid<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">input</span> last_word<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">input</span> clk<span class="token punctuation">,</span>rst<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">output</span> <span class="token keyword">reg</span> input_ready<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">output</span> <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>hash_data<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">output</span> <span class="token keyword">wire</span> output_valid<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>block_counter<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> length_counter<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>size<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>special<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>output_data<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> D<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> last_word_delayed<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>last_next<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">negedge</span> rst<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">begin</span>
</span><span class="code-line">last_next <span class="token operator">=</span> <span class="token number">2'b00</span><span class="token punctuation">;</span>
</span><span class="code-line">input_ready <span class="token operator">&#x3C;=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
</span><span class="code-line">length_counter <span class="token operator">&#x3C;=</span> <span class="token number">5'd31</span><span class="token punctuation">;</span>
</span><span class="code-line">special <span class="token operator">&#x3C;=</span> <span class="token number">2'd0</span><span class="token punctuation">;</span>
</span><span class="code-line">size <span class="token operator">&#x3C;=</span> <span class="token number">64'hffffffffffffffe0</span><span class="token punctuation">;</span>
</span><span class="code-line">D <span class="token operator">&#x3C;=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
</span><span class="code-line">last_word_delayed <span class="token operator">&#x3C;=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">sha_engine <span class="token function">Eng</span><span class="token punctuation">(</span>output_data<span class="token punctuation">,</span>clk<span class="token punctuation">,</span>block_counter<span class="token punctuation">,</span>rst<span class="token punctuation">,</span>output_valid<span class="token punctuation">,</span>hash_data<span class="token punctuation">,</span>last_word<span class="token punctuation">,</span>last_next<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">begin</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token function">if</span><span class="token punctuation">(</span>input_valid <span class="token operator">==</span> <span class="token number">1'b1</span> <span class="token operator">&#x26;&#x26;</span> input_ready <span class="token operator">==</span> <span class="token number">1'b1</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">begin</span>
</span><span class="code-line">		<span class="token function">if</span><span class="token punctuation">(</span>length_counter <span class="token operator">==</span> <span class="token number">5'd14</span><span class="token punctuation">)</span>
</span><span class="code-line">			input_ready <span class="token operator">&#x3C;=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">		length_counter <span class="token operator">=</span> length_counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line">	
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">begin</span>
</span><span class="code-line">	<span class="token function">if</span><span class="token punctuation">(</span>last_word <span class="token operator">==</span> <span class="token number">1'b1</span><span class="token punctuation">)</span>
</span><span class="code-line">		last_word_delayed <span class="token operator">&#x3C;=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> last_word_delayed<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">begin</span>
</span><span class="code-line">	<span class="token function">if</span><span class="token punctuation">(</span>length_counter<span class="token operator">&#x3C;=</span><span class="token number">13</span><span class="token punctuation">)</span>
</span><span class="code-line">		special <span class="token operator">&#x3C;=</span> <span class="token number">2'b01</span><span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">else</span>
</span><span class="code-line">		special <span class="token operator">&#x3C;=</span> <span class="token number">2'b11</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">begin</span>
</span><span class="code-line">	<span class="token function">case</span><span class="token punctuation">(</span>special<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token number">2'b00</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span>
</span><span class="code-line">			output_data <span class="token operator">&#x3C;=</span> input_data<span class="token punctuation">;</span>
</span><span class="code-line">			last_next <span class="token operator">&#x3C;=</span> <span class="token number">2'b00</span><span class="token punctuation">;</span>
</span><span class="code-line">			<span class="token keyword">end</span>
</span><span class="code-line">		<span class="token number">2'b01</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span>
</span><span class="code-line">			last_next <span class="token operator">&#x3C;=</span> <span class="token number">2'b01</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">			<span class="token function">if</span><span class="token punctuation">(</span>length_counter<span class="token operator">&#x3C;</span><span class="token number">15</span><span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">begin</span>
</span><span class="code-line">				<span class="token function">if</span><span class="token punctuation">(</span>length_counter <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&#x26;&#x26;</span> size <span class="token operator">==</span> <span class="token number">512</span><span class="token punctuation">)</span>
</span><span class="code-line">					output_data <span class="token operator">&#x3C;=</span> <span class="token operator">{</span><span class="token number">1'b1</span><span class="token punctuation">,</span><span class="token operator">{</span><span class="token number">31</span><span class="token operator">{</span><span class="token number">1'b0</span><span class="token operator">}}}</span><span class="token punctuation">;</span>
</span><span class="code-line">				<span class="token keyword">else</span> 
</span><span class="code-line">				<span class="token keyword">begin</span>
</span><span class="code-line">				D <span class="token operator">&#x3C;=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span>
</span><span class="code-line">				output_data <span class="token operator">&#x3C;=</span> <span class="token operator">{</span>D<span class="token punctuation">,</span><span class="token operator">{</span><span class="token number">31</span><span class="token operator">{</span><span class="token number">1'b0</span><span class="token operator">}}}</span><span class="token punctuation">;</span>
</span><span class="code-line">				<span class="token keyword">end</span>
</span><span class="code-line">			<span class="token keyword">end</span>
</span><span class="code-line">			<span class="token keyword">else</span> <span class="token function">if</span><span class="token punctuation">(</span>length_counter <span class="token operator">==</span> <span class="token number">15</span><span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">begin</span>
</span><span class="code-line">				output_data <span class="token operator">&#x3C;=</span> size<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">				length_counter <span class="token operator">&#x3C;=</span> length_counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">			<span class="token keyword">end</span>
</span><span class="code-line">			<span class="token keyword">else</span>
</span><span class="code-line">				output_data <span class="token operator">&#x3C;=</span> size<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">			<span class="token keyword">end</span>
</span><span class="code-line">		<span class="token number">2'b11</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span>
</span><span class="code-line">				last_next <span class="token operator">&#x3C;=</span> <span class="token number">2'b10</span><span class="token punctuation">;</span>
</span><span class="code-line">				D <span class="token operator">&#x3C;=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span>
</span><span class="code-line">				output_data <span class="token operator">&#x3C;=</span> <span class="token operator">{</span>D<span class="token punctuation">,</span><span class="token operator">{</span><span class="token number">31</span><span class="token operator">{</span><span class="token number">1'b0</span><span class="token operator">}}}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">			<span class="token keyword">end</span>
</span><span class="code-line">	<span class="token keyword">endcase</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">begin</span>
</span><span class="code-line">	<span class="token function">if</span><span class="token punctuation">(</span>block_counter <span class="token operator">==</span> <span class="token number">64</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">begin</span>
</span><span class="code-line">		length_counter <span class="token operator">&#x3C;=</span> <span class="token number">5'd31</span><span class="token punctuation">;</span>
</span><span class="code-line">		input_ready <span class="token operator">&#x3C;=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line">	<span class="token function">if</span><span class="token punctuation">(</span>block_counter <span class="token operator">==</span> <span class="token number">65</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">begin</span>
</span><span class="code-line">		<span class="token function">if</span><span class="token punctuation">(</span>special <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
</span><span class="code-line">			special <span class="token operator">&#x3C;=</span> <span class="token number">2'b01</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">else</span>
</span><span class="code-line">			special <span class="token operator">&#x3C;=</span> <span class="token number">2'd0</span><span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">begin</span>
</span><span class="code-line">	<span class="token function">if</span><span class="token punctuation">(</span>input_ready <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&#x26;&#x26;</span> special <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">		size <span class="token operator">&#x3C;=</span>  size <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> last_word<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">begin</span>
</span><span class="code-line">	<span class="token function">if</span><span class="token punctuation">(</span>length_counter <span class="token operator">==</span> <span class="token number">15</span><span class="token punctuation">)</span>
</span><span class="code-line">		size <span class="token operator">&#x3C;=</span> size <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span></code></pre>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="montgomery"><a aria-hidden="true" tabindex="-1" href="#montgomery"><span class="icon icon-link"></span></a>Montgomery</h3><div class="wrap-body">
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token constant">`timescale</span> <span class="token number">1</span>ns <span class="token operator">/</span> <span class="token number">1</span>ps
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">module</span> <span class="token function">mont_mult_modif</span><span class="token punctuation">(</span>
</span><span class="code-line">	x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
</span><span class="code-line">	clk<span class="token punctuation">,</span> reset<span class="token punctuation">,</span> start<span class="token punctuation">,</span>
</span><span class="code-line">	z<span class="token punctuation">,</span>
</span><span class="code-line">	done1
</span><span class="code-line">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">parameter</span> m <span class="token operator">=</span><span class="token number">192'hfffffffffffffffffffffffffffffffeffffffffffffffff</span><span class="token punctuation">,</span>
</span><span class="code-line">k <span class="token operator">=</span> <span class="token number">192</span><span class="token punctuation">,</span> logk <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> zero <span class="token operator">=</span> <span class="token operator">{</span> logk <span class="token operator">{</span><span class="token number">1'b0</span><span class="token operator">}}</span><span class="token punctuation">,</span>
</span><span class="code-line">minus_m <span class="token operator">=</span> <span class="token operator">{</span><span class="token number">1'b0</span><span class="token punctuation">,</span><span class="token number">192'h000000000000000000000000000000010000000000000001</span><span class="token operator">}</span><span class="token punctuation">,</span>
</span><span class="code-line">delay <span class="token operator">=</span> <span class="token number">8'b01100000</span><span class="token punctuation">,</span> COUNT <span class="token operator">=</span> <span class="token number">8'b10111111</span><span class="token punctuation">;</span> <span class="token comment">//(k-1,logk)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">parameter</span> S0 <span class="token operator">=</span> <span class="token number">3'd0</span><span class="token punctuation">,</span> S1 <span class="token operator">=</span> <span class="token number">3'd1</span><span class="token punctuation">,</span> S2 <span class="token operator">=</span> <span class="token number">3'd2</span><span class="token punctuation">,</span> S3 <span class="token operator">=</span> <span class="token number">3'd3</span><span class="token punctuation">,</span> S4 <span class="token operator">=</span> <span class="token number">3'd4</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">input</span> <span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> x<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">input</span> <span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> y<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">input</span> clk<span class="token punctuation">,</span> reset<span class="token punctuation">,</span> start<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">output</span> <span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> z<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">output</span> done1<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span>logk<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> count<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span>logk<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> timer_state<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span>k<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> pc<span class="token punctuation">,</span> psa<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> int_x<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">wire</span> equal_zero<span class="token punctuation">,</span> time_out<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">wire</span> <span class="token punctuation">[</span>k<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> y_by_xi<span class="token punctuation">,</span> half_ac<span class="token punctuation">,</span> half_as<span class="token punctuation">,</span> half_bc<span class="token punctuation">,</span> half_bs<span class="token punctuation">,</span> next_pc<span class="token punctuation">,</span> next_psa<span class="token punctuation">,</span> p<span class="token punctuation">,</span> p_minus_m<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">wire</span> <span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ac<span class="token punctuation">,</span> as<span class="token punctuation">,</span> bc<span class="token punctuation">,</span> bs<span class="token punctuation">,</span> long_m<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">wire</span> xi<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> load<span class="token punctuation">,</span> ce_p<span class="token punctuation">,</span> load_timer<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> current_state<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> next_state<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> done<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">assign</span> done1 <span class="token operator">=</span> done<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">genvar</span> i<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">generate</span> <span class="token function">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&#x3C;</span>k<span class="token punctuation">;</span>i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> 
</span><span class="code-line">	<span class="token keyword">begin</span><span class="token punctuation">:</span>and_gates
</span><span class="code-line">		<span class="token keyword">and</span> <span class="token function">a</span><span class="token punctuation">(</span>y_by_xi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>xi<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endgenerate</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">assign</span> y_by_xi<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">generate</span> <span class="token function">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&#x3C;=</span>k<span class="token punctuation">;</span>i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> 
</span><span class="code-line">	<span class="token keyword">begin</span><span class="token punctuation">:</span>first_csa
</span><span class="code-line">		<span class="token keyword">xor</span> <span class="token function">x</span><span class="token punctuation">(</span>as<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>pc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>psa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>y_by_xi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">wire</span> w1<span class="token punctuation">,</span>w2<span class="token punctuation">,</span>w3<span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">and</span> <span class="token function">a1</span><span class="token punctuation">(</span>w1<span class="token punctuation">,</span>pc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>psa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">and</span> <span class="token function">a2</span><span class="token punctuation">(</span>w2<span class="token punctuation">,</span>pc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>y_by_xi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">and</span> <span class="token function">a3</span><span class="token punctuation">(</span>w3<span class="token punctuation">,</span>psa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>y_by_xi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">or</span> <span class="token function">o</span><span class="token punctuation">(</span>ac<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>w1<span class="token punctuation">,</span>w2<span class="token punctuation">,</span>w3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endgenerate</span>
</span><span class="code-line"><span class="token keyword">assign</span> ac<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">,</span> as<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">,</span> long_m <span class="token operator">=</span> <span class="token operator">{{</span><span class="token number">2'b00</span><span class="token operator">}</span><span class="token punctuation">,</span>m<span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">generate</span> <span class="token function">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&#x3C;=</span>k<span class="token punctuation">;</span>i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> 
</span><span class="code-line">	<span class="token keyword">begin</span><span class="token punctuation">:</span>second_csa
</span><span class="code-line">		<span class="token keyword">xor</span> <span class="token function">x</span><span class="token punctuation">(</span>bs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>ac<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>as<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>long_m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">wire</span> w1<span class="token punctuation">,</span>w2<span class="token punctuation">,</span>w3<span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">and</span> <span class="token function">a1</span><span class="token punctuation">(</span>w1<span class="token punctuation">,</span>ac<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>as<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">and</span> <span class="token function">a2</span><span class="token punctuation">(</span>w2<span class="token punctuation">,</span>ac<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>long_m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">and</span> <span class="token function">a3</span><span class="token punctuation">(</span>w3<span class="token punctuation">,</span>as<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>long_m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">or</span> <span class="token function">o</span><span class="token punctuation">(</span>bc<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>w1<span class="token punctuation">,</span>w2<span class="token punctuation">,</span>w3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endgenerate</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">assign</span> bc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">,</span> bs<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> ac<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">	half_as <span class="token operator">=</span> as<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> half_ac <span class="token operator">=</span> ac<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">	half_bs <span class="token operator">=</span> bs<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> half_bc <span class="token operator">=</span> bc<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">assign</span> next_pc <span class="token operator">=</span> <span class="token punctuation">(</span>as<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1'b0</span><span class="token punctuation">)</span><span class="token operator">?</span> half_ac<span class="token punctuation">:</span>half_bc<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">assign</span> next_psa <span class="token operator">=</span> <span class="token punctuation">(</span>as<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1'b0</span><span class="token punctuation">)</span><span class="token operator">?</span> half_as<span class="token punctuation">:</span>half_bs<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always@</span><span class="token punctuation">(</span><span class="token function">posedge</span><span class="token punctuation">(</span>clk<span class="token punctuation">)</span><span class="token punctuation">)</span> 
</span><span class="code-line">	<span class="token keyword">begin</span><span class="token punctuation">:</span>parallel_register
</span><span class="code-line">		<span class="token keyword">if</span> <span class="token punctuation">(</span>load<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">			pc <span class="token operator">=</span> <span class="token operator">{</span> k<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">{</span><span class="token number">1'b0</span><span class="token operator">}</span> <span class="token operator">}</span><span class="token punctuation">;</span> psa <span class="token operator">=</span> <span class="token operator">{</span> k<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">{</span><span class="token number">1'b0</span><span class="token operator">}</span> <span class="token operator">}</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ce_p<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">			pc <span class="token operator">=</span> next_pc<span class="token punctuation">;</span> psa <span class="token operator">=</span> next_psa<span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">	<span class="token keyword">end</span> 
</span><span class="code-line"><span class="token keyword">assign</span> equal_zero <span class="token operator">=</span> <span class="token punctuation">(</span>count<span class="token operator">==</span>zero<span class="token punctuation">)</span><span class="token operator">?</span> <span class="token number">1'b1</span><span class="token punctuation">:</span><span class="token number">1'b0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">assign</span> p <span class="token operator">=</span> psa <span class="token operator">+</span> pc<span class="token punctuation">,</span> p_minus_m <span class="token operator">=</span> p <span class="token operator">+</span> minus_m<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">assign</span> z <span class="token operator">=</span> <span class="token punctuation">(</span>p_minus_m<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1'b0</span><span class="token punctuation">)</span><span class="token operator">?</span> p<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>p_minus_m<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always@</span><span class="token punctuation">(</span><span class="token function">posedge</span><span class="token punctuation">(</span>clk<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">begin</span><span class="token punctuation">:</span>shift_register
</span><span class="code-line">		<span class="token keyword">integer</span> i<span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">if</span> <span class="token punctuation">(</span>load<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> int_x <span class="token operator">=</span> x<span class="token punctuation">;</span> 
</span><span class="code-line">		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ce_p<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">			<span class="token function">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&#x3C;=</span>k<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> int_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> int_x<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">			int_x<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">	<span class="token keyword">end</span> 
</span><span class="code-line"><span class="token keyword">assign</span> xi <span class="token operator">=</span> int_x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always@</span><span class="token punctuation">(</span><span class="token function">posedge</span><span class="token punctuation">(</span>clk<span class="token punctuation">)</span><span class="token punctuation">)</span> 
</span><span class="code-line">	<span class="token keyword">begin</span><span class="token punctuation">:</span>counter
</span><span class="code-line">		<span class="token keyword">if</span> <span class="token punctuation">(</span>load<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> count <span class="token operator">&#x3C;=</span> COUNT<span class="token punctuation">;</span>  
</span><span class="code-line">		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ce_p<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> count <span class="token operator">&#x3C;=</span> count <span class="token operator">-</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">end</span> 
</span><span class="code-line">	
</span><span class="code-line">	<span class="token important">always@</span><span class="token punctuation">(</span>clk<span class="token punctuation">,</span> current_state<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">			<span class="token function">case</span><span class="token punctuation">(</span>current_state<span class="token punctuation">)</span> 
</span><span class="code-line">				S0<span class="token punctuation">:</span> <span class="token keyword">begin</span> ce_p <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load_timer <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> done <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">				S1<span class="token punctuation">:</span> <span class="token keyword">begin</span> ce_p <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load_timer <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> done <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">				S2<span class="token punctuation">:</span> <span class="token keyword">begin</span> ce_p <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> load_timer <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> done <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">				S3<span class="token punctuation">:</span> <span class="token keyword">begin</span> ce_p <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> load <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load_timer <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> done <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">				S4<span class="token punctuation">:</span> <span class="token keyword">begin</span> ce_p <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load_timer <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> done <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">				<span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">begin</span> ce_p <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load <span class="token operator">=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span> load_timer <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> done <span class="token operator">=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
</span><span class="code-line">			<span class="token keyword">endcase</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line">	
</span><span class="code-line">	<span class="token important">always@</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span> <span class="token keyword">begin</span>	
</span><span class="code-line">		<span class="token function">if</span><span class="token punctuation">(</span>reset<span class="token punctuation">)</span> current_state <span class="token operator">=</span> S0<span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">else</span> current_state <span class="token operator">=</span> next_state<span class="token punctuation">;</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line">	
</span><span class="code-line">	<span class="token important">always@</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">		next_state <span class="token operator">=</span> current_state<span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">if</span> <span class="token punctuation">(</span>reset<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> next_state <span class="token operator">=</span> S0<span class="token punctuation">;</span> 
</span><span class="code-line">		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>clk<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">			<span class="token function">case</span><span class="token punctuation">(</span>next_state<span class="token punctuation">)</span>
</span><span class="code-line">				S0<span class="token punctuation">:</span> <span class="token function">if</span><span class="token punctuation">(</span>start<span class="token operator">==</span><span class="token number">1'b0</span><span class="token punctuation">)</span> next_state <span class="token operator">=</span> S1<span class="token punctuation">;</span>
</span><span class="code-line">				S1<span class="token punctuation">:</span> <span class="token function">if</span><span class="token punctuation">(</span>start<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> next_state <span class="token operator">=</span> S2<span class="token punctuation">;</span>
</span><span class="code-line">				S2<span class="token punctuation">:</span> next_state <span class="token operator">=</span> S3<span class="token punctuation">;</span>
</span><span class="code-line">				S3<span class="token punctuation">:</span> <span class="token function">if</span><span class="token punctuation">(</span>equal_zero<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> next_state <span class="token operator">=</span> S4<span class="token punctuation">;</span>
</span><span class="code-line">				S4<span class="token punctuation">:</span> <span class="token function">if</span><span class="token punctuation">(</span>time_out<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> next_state <span class="token operator">=</span> S0<span class="token punctuation">;</span>
</span><span class="code-line">				<span class="token keyword">default</span><span class="token punctuation">:</span> next_state <span class="token operator">=</span> S0<span class="token punctuation">;</span>
</span><span class="code-line">			<span class="token keyword">endcase</span>
</span><span class="code-line">		<span class="token keyword">end</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always@</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">begin</span><span class="token punctuation">:</span>timer
</span><span class="code-line">		<span class="token keyword">if</span> <span class="token punctuation">(</span>clk<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">			<span class="token keyword">if</span> <span class="token punctuation">(</span>load_timer<span class="token operator">==</span><span class="token number">1'b1</span><span class="token punctuation">)</span> timer_state <span class="token operator">=</span> delay<span class="token punctuation">;</span> 
</span><span class="code-line">			<span class="token keyword">else</span> timer_state <span class="token operator">=</span> timer_state <span class="token operator">-</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
</span><span class="code-line">		<span class="token keyword">end</span>
</span><span class="code-line">	<span class="token keyword">end</span>
</span><span class="code-line">	
</span><span class="code-line"><span class="token keyword">assign</span> time_out <span class="token operator">=</span> <span class="token punctuation">(</span>timer_state<span class="token operator">==</span>zero<span class="token punctuation">)</span><span class="token operator">?</span> <span class="token number">1'b1</span><span class="token punctuation">:</span><span class="token number">1'b0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span></code></pre>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="grain_128"><a aria-hidden="true" tabindex="-1" href="#grain_128"><span class="icon icon-link"></span></a>Grain_128</h3><div class="wrap-body">
<pre class="language-verilog"><code class="language-verilog code-highlight"><span class="code-line"><span class="token keyword">module</span> h_x
</span><span class="code-line"><span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token keyword">input</span> s8<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s13<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s20<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s42<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s60<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s79<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s95<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b12<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b95<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">output</span> ho
</span><span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 通过一系列逻辑操作计算输出ho</span>
</span><span class="code-line"><span class="token keyword">assign</span> ho <span class="token operator">=</span> <span class="token punctuation">(</span>b12 <span class="token operator">&#x26;</span> s8<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>s13 <span class="token operator">&#x26;</span> s20<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b95 <span class="token operator">&#x26;</span> s42<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>s60 <span class="token operator">&#x26;</span> s79<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b12 <span class="token operator">&#x26;</span> s95 <span class="token operator">&#x26;</span> b95<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">module</span> feedback_linear
</span><span class="code-line"><span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token keyword">input</span> s0<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s7<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s38<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s70<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s81<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> s96<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">output</span> lfb
</span><span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 通过异或逻辑操作计算输出lfb</span>
</span><span class="code-line"><span class="token keyword">assign</span> lfb <span class="token operator">=</span> s0 <span class="token operator">^</span> s7 <span class="token operator">^</span> s38 <span class="token operator">^</span> s70 <span class="token operator">^</span> s81 <span class="token operator">^</span> s96<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">module</span> feedback_non_linear
</span><span class="code-line"><span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token keyword">input</span> b0<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b26<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b56<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b91<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b96<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b3<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b67<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b11<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b13<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b17<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b18<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b27<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b59<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b40<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b48<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b61<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b65<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b68<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> b84<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">output</span> nfb
</span><span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 通过一系列异或和与逻辑操作计算输出nfb</span>
</span><span class="code-line"><span class="token keyword">assign</span> nfb <span class="token operator">=</span> b0 <span class="token operator">^</span> b26 <span class="token operator">^</span> b56 <span class="token operator">^</span> b91 <span class="token operator">^</span> b96 <span class="token operator">^</span> <span class="token punctuation">(</span>b3 <span class="token operator">&#x26;</span> b67<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b11 <span class="token operator">&#x26;</span> b13<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b17 <span class="token operator">&#x26;</span> b18<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b27 <span class="token operator">&#x26;</span> b59<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b40 <span class="token operator">&#x26;</span> b48<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b61 <span class="token operator">&#x26;</span> b65<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b68 <span class="token operator">&#x26;</span> b84<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">module</span> grain128 
</span><span class="code-line"><span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token keyword">input</span> clk<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> rst<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> key<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> iv<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">input</span> gen<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">output</span> <span class="token keyword">reg</span> rdy<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">output</span> z<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> tag
</span><span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">localparam</span> INIT <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">localparam</span> RDY  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> s<span class="token punctuation">;</span>            <span class="token comment">//LFSR 线性反馈移位寄存器</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> b<span class="token punctuation">;</span>            <span class="token comment">//NFSR 非线性反馈移位寄存器</span>
</span><span class="code-line"><span class="token keyword">reg</span> curr_state <span class="token operator">=</span> INIT<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> next_state <span class="token operator">=</span> INIT<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> cnt  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token comment">//Counter 计数器</span>
</span><span class="code-line"><span class="token keyword">reg</span> m          <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token comment">//Mode 模式选择</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">wire</span> f<span class="token punctuation">,</span>g<span class="token punctuation">,</span>h<span class="token punctuation">;</span>               <span class="token comment">//用于存储反馈模块的输出</span>
</span><span class="code-line"><span class="token keyword">wire</span> nfb<span class="token punctuation">,</span> lfb<span class="token punctuation">;</span>            <span class="token comment">//用于存储非线性反馈和线性反馈的输出</span>
</span><span class="code-line"><span class="token keyword">wire</span> mo<span class="token punctuation">;</span>                  <span class="token comment">//MUX out 多路选择器输出</span>
</span><span class="code-line"><span class="token keyword">wire</span> y<span class="token punctuation">;</span>                   <span class="token comment">//y</span>
</span><span class="code-line"><span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> key_in<span class="token punctuation">;</span>      <span class="token comment">//Flipped key 翻转后的密钥</span>
</span><span class="code-line"><span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> iv_in<span class="token punctuation">;</span>        <span class="token comment">//Flipped iv 翻转后的初始化向量</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 实例化反馈模块</span>
</span><span class="code-line">feedback_linear FB_L <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">feedback_non_linear FB_N <span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">h_x HX <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">79</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 计算mo</span>
</span><span class="code-line"><span class="token keyword">assign</span> mo  <span class="token operator">=</span> m <span class="token operator">&#x26;</span> y<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// 计算lfb和nfb</span>
</span><span class="code-line"><span class="token keyword">assign</span> lfb <span class="token operator">=</span> f <span class="token operator">^</span> mo<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">assign</span> nfb <span class="token operator">=</span> g <span class="token operator">^</span> mo <span class="token operator">^</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// 计算y</span>
</span><span class="code-line"><span class="token keyword">assign</span> y   <span class="token operator">=</span> h <span class="token operator">^</span> s<span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">]</span> <span class="token operator">^</span> b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> b<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">^</span> b<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">^</span> b<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span> <span class="token operator">^</span> b<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">^</span> b<span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">]</span> <span class="token operator">^</span> b<span class="token punctuation">[</span><span class="token number">89</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// 输出z等于y</span>
</span><span class="code-line"><span class="token keyword">assign</span> z   <span class="token operator">=</span> y<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">assign</span> tag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 生成翻转后的初始化向量</span>
</span><span class="code-line"><span class="token keyword">generate</span>
</span><span class="code-line">    <span class="token keyword">genvar</span> i<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&#x3C;</span> <span class="token number">96</span><span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">        <span class="token keyword">assign</span> iv_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> iv<span class="token punctuation">[</span><span class="token number">95</span><span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endgenerate</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 生成翻转后的密钥</span>
</span><span class="code-line"><span class="token keyword">generate</span>
</span><span class="code-line">    <span class="token keyword">genvar</span> j<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">for</span><span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&#x3C;</span> <span class="token number">128</span><span class="token punctuation">;</span> j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">        <span class="token keyword">assign</span> key_in<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">127</span><span class="token operator">-</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endgenerate</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>rst<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">        curr_state <span class="token operator">&#x3C;=</span> INIT<span class="token punctuation">;</span>
</span><span class="code-line">        s          <span class="token operator">&#x3C;=</span> <span class="token operator">{{</span><span class="token number">32</span><span class="token operator">{</span><span class="token number">1'b1</span><span class="token operator">}}</span><span class="token punctuation">,</span>iv_in<span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">        b          <span class="token operator">&#x3C;=</span> key_in<span class="token punctuation">;</span>
</span><span class="code-line">        cnt        <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">end</span>
</span><span class="code-line">    <span class="token keyword">else</span> <span class="token keyword">begin</span>
</span><span class="code-line">        curr_state <span class="token operator">&#x3C;=</span> next_state<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">end</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token punctuation">(</span>curr_state<span class="token punctuation">)</span>
</span><span class="code-line">        INIT <span class="token punctuation">:</span> <span class="token keyword">begin</span>
</span><span class="code-line">            m   <span class="token operator">&#x3C;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">            rdy <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">                next_state <span class="token operator">&#x3C;=</span> RDY<span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">end</span>
</span><span class="code-line">            <span class="token keyword">else</span> <span class="token keyword">begin</span>
</span><span class="code-line">                next_state <span class="token operator">&#x3C;=</span> INIT<span class="token punctuation">;</span>
</span><span class="code-line">                cnt        <span class="token operator">&#x3C;=</span> cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">end</span>
</span><span class="code-line">            s <span class="token operator">=</span> <span class="token operator">{</span>lfb<span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">            b <span class="token operator">=</span> <span class="token operator">{</span>nfb<span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">        RDY <span class="token punctuation">:</span> <span class="token keyword">begin</span>
</span><span class="code-line">            rdy <span class="token operator">&#x3C;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">            m   <span class="token operator">&#x3C;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>gen <span class="token operator">&#x26;&#x26;</span> rdy<span class="token punctuation">)</span> <span class="token keyword">begin</span>
</span><span class="code-line">                s <span class="token operator">=</span> <span class="token operator">{</span>lfb<span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">                b <span class="token operator">=</span> <span class="token operator">{</span>nfb<span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">}</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">end</span>
</span><span class="code-line">            next_state <span class="token operator">&#x3C;=</span> RDY<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">end</span>
</span><span class="code-line">    <span class="token keyword">endcase</span>
</span><span class="code-line"><span class="token keyword">end</span>
</span><span class="code-line"><span class="token keyword">endmodule</span>
</span><span class="code-line">
</span></code></pre>
</div></div></div></div></div></div><script src="https://giscus.app/client.js" data-repo="jaywcjlove/reference" data-repo-id="R_kgDOID2-Mw" data-category="Q&#x26;A" data-category-id="DIC_kwDOID2-M84CS5wo" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="dark" data-lang="zh-CN" crossorigin="anonymous" async></script><div class="giscus"></div></div><footer class="footer-wrap"><footer class="max-container">Copyright (c) <b>2024</b> xin-li™</footer></footer><script src="..\/data.js?v=1.5.3" defer></script><script src="..\/js/fuse.min.js?v=1.5.3" defer></script><script src="..\/js/main.js?v=1.5.3" defer></script><div id="mysearch"><div class="mysearch-box"><div class="mysearch-input"><div><svg xmlns="http://www.w3.org/2000/svg" height="1em" width="1em" viewBox="0 0 18 18">
  <path fill="currentColor" d="M17.71,16.29 L14.31,12.9 C15.4069846,11.5024547 16.0022094,9.77665502 16,8 C16,3.581722 12.418278,0 8,0 C3.581722,0 0,3.581722 0,8 C0,12.418278 3.581722,16 8,16 C9.77665502,16.0022094 11.5024547,15.4069846 12.9,14.31 L16.29,17.71 C16.4777666,17.8993127 16.7333625,18.0057983 17,18.0057983 C17.2666375,18.0057983 17.5222334,17.8993127 17.71,17.71 C17.8993127,17.5222334 18.0057983,17.2666375 18.0057983,17 C18.0057983,16.7333625 17.8993127,16.4777666 17.71,16.29 Z M2,8 C2,4.6862915 4.6862915,2 8,2 C11.3137085,2 14,4.6862915 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 Z"></path>
</svg><input id="mysearch-input" type="search" placeholder="搜索" autocomplete="off"><div class="mysearch-clear"></div></div><button id="mysearch-close" type="button">搜索</button></div><div class="mysearch-result"><div id="mysearch-menu"></div><div id="mysearch-content"></div></div></div></div></body>
</html>
